Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-19 20:15:31 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-19 20:15:31 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-19 20:15:31 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-19 20:15:31 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-19 20:15:32 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-19 20:15:32 +0400
  [1m[36mProductType Load (39.6ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" ORDER BY "product_types"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" ORDER BY "product_types"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to RemoveFilledTypes (20200919162956)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[36mProductType Destroy (0.5ms)[0m  [1m[31mDELETE FROM "product_types" WHERE "product_types"."id_name" IN ($1, $2, $3)[0m  [["id_name", "catalog_product"], ["id_name", "service"], ["id_name", "working_hour"]]
  â†³ db/migrate/20200919162956_remove_filled_types.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200919162956"]]
  â†³ bin/rails:9
  [1m[35m (3.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
Migrating to AddAndChangeProductTypeTable (20200919163118)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (5.7ms)[0m  [1m[35mALTER TABLE "product_types" ALTER COLUMN "name" TYPE json[0m
  â†³ db/migrate/20200919163118_add_and_change_product_type_table.rb:3
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddAndChangeProductTypeTable (20200919163118)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (66.6ms)[0m  [1m[35mALTER TABLE "product_types" ALTER COLUMN "name" TYPE json USING name::json[0m
  â†³ db/migrate/20200919163118_add_and_change_product_type_table.rb:3
  [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddAndChangeProductTypeTable (20200919163118)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (46.3ms)[0m  [1m[35mALTER TABLE "product_types" ALTER COLUMN "name" TYPE json USING name::json[0m
  â†³ db/migrate/20200919163118_add_and_change_product_type_table.rb:3
  [1m[35m (2.9ms)[0m  [1m[35mALTER TABLE "product_types" ADD "active" boolean DEFAULT TRUE[0m
  â†³ db/migrate/20200919163118_add_and_change_product_type_table.rb:4
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200919163118"]]
  â†³ bin/rails:9
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-19 21:08:06 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-19 21:08:06 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-19 21:08:06 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-19 21:08:06 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-19 21:08:07 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-19 21:08:07 +0400
Started POST "/en/product_types" for 127.0.0.1 at 2020-09-19 21:10:28 +0400
Processing by ProductTypesController#create as JSON
  Parameters: {"name"=>{"no"=>"aba1", "en"=>"aba1"}, "active"=>true, "locale"=>"en", "product_type"=>{"name"=>{"no"=>"aba1", "en"=>"aba1"}, "active"=>true}}
Unpermitted parameters: :format, :locale, :product_type
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_type_service.rb:29
  [1m[36mProductType Create (3.6ms)[0m  [1m[32mINSERT INTO "product_types" ("name", "id_name") VALUES ($1, $2) RETURNING "id"[0m  [["name", "{\"no\":\"aba1\",\"en\":\"aba1\"}"], ["id_name", "aba1"]]
  â†³ app/services/products/product_type_service.rb:29
  [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_type_service.rb:29
Completed 201 Created in 114ms (Views: 0.2ms | ActiveRecord: 10.9ms)


Started PUT "/en/product_types" for 127.0.0.1 at 2020-09-19 21:11:01 +0400
Processing by ProductTypesController#update as JSON
  Parameters: {"id"=>4, "name"=>{"no"=>"aba 2", "en"=>"aba 2"}, "active"=>true, "locale"=>"en", "product_type"=>{"id"=>4, "name"=>{"no"=>"aba 2", "en"=>"aba 2"}, "active"=>true}}
Unpermitted parameters: :format, :locale, :product_type
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_type_service.rb:59
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_type_service.rb:38
  [1m[36mProductType Update (0.3ms)[0m  [1m[33mUPDATE "product_types" SET "name" = $1 WHERE "product_types"."id" = $2[0m  [["name", "{\"no\":\"aba 2\",\"en\":\"aba 2\"}"], ["id", 4]]
  â†³ app/services/products/product_type_service.rb:38
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_type_service.rb:38
Completed 200 OK in 24ms (Views: 0.1ms | ActiveRecord: 9.8ms)


Started DELETE "/en/product_types?id=4" for 127.0.0.1 at 2020-09-19 21:11:15 +0400
Processing by ProductTypesController#destroy as JSON
  Parameters: {"id"=>"4", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProductType Load (0.2ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_type_service.rb:59
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_type_service.rb:46
  [1m[36mProductType Destroy (0.2ms)[0m  [1m[31mDELETE FROM "product_types" WHERE "product_types"."id" = $1[0m  [["id", 4]]
  â†³ app/services/products/product_type_service.rb:46
  [1m[35m (36.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_type_service.rb:46
Completed 200 OK in 39ms (Views: 0.3ms | ActiveRecord: 36.6ms)


Started GET "/en/product_types/product_type_list" for 127.0.0.1 at 2020-09-19 21:12:20 +0400
Processing by ProductTypesController#list as JSON
  Parameters: {"locale"=>"en"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 6ms (Views: 0.4ms | ActiveRecord: 0.0ms)


Started GET "/en/product_types/product_type_list" for 127.0.0.1 at 2020-09-19 21:12:32 +0400
Processing by ProductTypesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms)


  
NoMethodError (undefined method `empty?' for nil:NilClass):
  
app/services/products/product_type_service.rb:52:in `list'
app/controllers/product_types_controller.rb:28:in `list'
Started GET "/en/product_types/product_type_list" for 127.0.0.1 at 2020-09-19 21:13:02 +0400
Processing by ProductTypesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 4ms (Views: 0.2ms | ActiveRecord: 0.0ms)


Started GET "/en/product_types/product_type_list" for 127.0.0.1 at 2020-09-19 21:13:27 +0400
Processing by ProductTypesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT "product_types".* FROM "product_types"[0m
  â†³ app/services/products/product_type_service.rb:23
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 1.1ms)


  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-20 01:59:24 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-20 01:59:24 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-20 01:59:24 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-20 01:59:24 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-20 01:59:25 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-20 01:59:25 +0400
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[36mProductType Load (1.1ms)[0m  [1m[34mSELECT "product_types".* FROM "product_types"[0m
  [1m[36mProductType Load (0.8ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" ORDER BY "product_types"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for ::1 at 2020-09-21 17:12:55 +0400
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui-standalone-preset.js" for ::1 at 2020-09-21 17:12:56 +0400
Started GET "/api-docs/swagger-ui.css" for ::1 at 2020-09-21 17:12:56 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for ::1 at 2020-09-21 17:12:56 +0400
Started GET "/api-docs/v1/swagger.json" for ::1 at 2020-09-21 17:12:56 +0400
Started GET "/api-docs/favicon-32x32.png" for ::1 at 2020-09-21 17:12:57 +0400
Started GET "/en/categories/category_list" for ::1 at 2020-09-21 17:13:09 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 25ms (Views: 0.3ms | ActiveRecord: 8.2ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for ::1 at 2020-09-21 17:14:06 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for ::1 at 2020-09-21 17:14:06 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for ::1 at 2020-09-21 17:14:06 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for ::1 at 2020-09-21 17:14:06 +0400
Started GET "/api-docs/v1/swagger.json" for ::1 at 2020-09-21 17:14:07 +0400
Started GET "/api-docs/favicon-32x32.png" for ::1 at 2020-09-21 17:14:07 +0400
Started GET "/%7Blocale%7D/categories/category_list" for ::1 at 2020-09-21 17:14:14 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"{locale}"}
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms)


  
I18n::InvalidLocale ("{locale}" is not a valid locale):
  
app/controllers/application_controller.rb:8:in `set_locale'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for ::1 at 2020-09-21 17:17:55 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for ::1 at 2020-09-21 17:17:55 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for ::1 at 2020-09-21 17:17:55 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for ::1 at 2020-09-21 17:17:55 +0400
Started GET "/api-docs/v1/swagger.json" for ::1 at 2020-09-21 17:17:55 +0400
Started GET "/api-docs/favicon-32x32.png" for ::1 at 2020-09-21 17:17:55 +0400
Started GET "/en/categories/category_list" for ::1 at 2020-09-21 17:18:09 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 5.4ms)


Started GET "/no/categories/category_list" for ::1 at 2020-09-21 17:18:17 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"no"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms)


Started PUT "/en/categories" for ::1 at 2020-09-21 17:19:08 +0400
Processing by CategoriesController#update as JSON
  Parameters: {"id"=>1, "name"=>"buka", "locale"=>"en", "category"=>{"id"=>1, "name"=>"buka"}}
Unpermitted parameter: :name
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:58
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/category_sub_categories/categories_service.rb:37
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/category_sub_categories/categories_service.rb:37
Completed 200 OK in 44ms (Views: 0.1ms | ActiveRecord: 0.6ms)


Started GET "/no/categories/category_list" for ::1 at 2020-09-21 17:19:22 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"no"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)


Started GET "/en/categories/category_list" for ::1 at 2020-09-21 17:19:30 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms)


Started GET "/en/categories/category_list" for ::1 at 2020-09-21 17:24:34 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms)


Started PUT "/en/categories" for ::1 at 2020-09-21 17:43:53 +0400
Processing by CategoriesController#update as JSON
  Parameters: {"id"=>1, "name"=>{"en"=>"buka"}, "locale"=>"en", "category"=>{"id"=>1, "name"=>{"en"=>"buka"}}}
  [1m[36mCategory Load (0.5ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:58
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/category_sub_categories/categories_service.rb:37
  [1m[36mCategory Update (5.8ms)[0m  [1m[33mUPDATE "categories" SET "name" = $1 WHERE "categories"."id" = $2[0m  [["name", "{\"en\":\"buka\"}"], ["id", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:37
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/category_sub_categories/categories_service.rb:37
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 7.4ms)


Started GET "/en/categories/category_list" for ::1 at 2020-09-21 17:43:58 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)


Started GET "/no/categories/category_list" for ::1 at 2020-09-21 17:44:05 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"no"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:52
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)


Started PUT "/en/categories" for ::1 at 2020-09-21 17:44:54 +0400
Processing by CategoriesController#update as JSON
  Parameters: {"id"=>1, "name"=>{"en"=>"buka"}, "locale"=>"en", "category"=>{"id"=>1, "name"=>{"en"=>"buka"}}}
  [1m[36mCategory Load (0.9ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:59
  [1m[36mCategory Load (0.8ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" ORDER BY "categories"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):18
  [1m[36mCACHE Category Load (0.0ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" ORDER BY "categories"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):19
  [1m[36mCACHE Category Load (0.0ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:59
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/category_sub_categories/categories_service.rb:38
  [1m[36mCategory Update (0.3ms)[0m  [1m[33mUPDATE "categories" SET "name" = $1 WHERE "categories"."id" = $2[0m  [["name", "{\"en\":\"buka\",\"no\":\"change_1\"}"], ["id", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:38
  [1m[35m (35.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/category_sub_categories/categories_service.rb:38
Completed 200 OK in 595557ms (Views: 0.2ms | ActiveRecord: 47.4ms)


Started GET "/no/categories/category_list" for ::1 at 2020-09-21 17:55:34 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"no"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:54
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 12ms (Views: 0.4ms | ActiveRecord: 3.6ms)


Started PUT "/en/categories" for ::1 at 2020-09-21 17:55:48 +0400
Processing by CategoriesController#update as JSON
  Parameters: {"id"=>2, "name"=>{"en"=>"buka"}, "locale"=>"en", "category"=>{"id"=>2, "name"=>{"en"=>"buka"}}}
  [1m[36mCategory Load (1.0ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:67
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/category_sub_categories/categories_service.rb:39
  [1m[36mCategory Update (1.0ms)[0m  [1m[33mUPDATE "categories" SET "name" = $1 WHERE "categories"."id" = $2[0m  [["name", "{\"en\":\"buka\",\"no\":\"category_no 2\"}"], ["id", 2]]
  â†³ app/services/category_sub_categories/categories_service.rb:39
  [1m[35m (36.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/category_sub_categories/categories_service.rb:39
Completed 200 OK in 6373ms (Views: 0.6ms | ActiveRecord: 38.7ms)


Started GET "/no/categories/category_list" for ::1 at 2020-09-21 17:56:05 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"no"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:54
  [1m[36mCategory Load (0.1ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)


Started GET "/en/categories/category_list" for ::1 at 2020-09-21 17:56:17 +0400
Processing by CategoriesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCategory Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "categories" LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/category_sub_categories/categories_service.rb:54
  [1m[36mCategory Load (0.2ms)[0m  [1m[34mSELECT "categories".* FROM "categories"[0m
  â†³ app/services/category_sub_categories/categories_service.rb:22
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms)


Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-21 23:53:31 +0400
  [1m[35m (1.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-21 23:53:31 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-21 23:53:31 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-21 23:53:31 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-21 23:53:32 +0400
Started GET "/en/supplier/business_types" for 127.0.0.1 at 2020-09-21 23:53:47 +0400
Processing by SuppliersController#business_types as JSON
  Parameters: {"locale"=>"en"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 4ms (Views: 0.2ms | ActiveRecord: 0.0ms)


Started GET "/en/supplier/business_types" for 127.0.0.1 at 2020-09-21 23:54:29 +0400
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SuppliersController#business_types as JSON
  Parameters: {"locale"=>"en"}
  [1m[36mBusinessType Load (7.8ms)[0m  [1m[34mSELECT "business_types".* FROM "business_types"[0m
  â†³ app/services/suppliers/supplier_helper_service.rb:14
Completed 200 OK in 80ms (Views: 0.8ms | ActiveRecord: 26.2ms)


Started GET "/en/supplier/integration_systems" for 127.0.0.1 at 2020-09-21 23:56:25 +0400
Processing by SuppliersController#integration_systems as JSON
  Parameters: {"locale"=>"en"}
  [1m[36mIntegrationSystem Load (4.6ms)[0m  [1m[34mSELECT "integration_systems".* FROM "integration_systems"[0m
  â†³ app/services/suppliers/supplier_helper_service.rb:18
Completed 200 OK in 65ms (Views: 0.2ms | ActiveRecord: 8.6ms)


  [1m[36mBusinessType Load (0.8ms)[0m  [1m[34mSELECT "business_types".* FROM "business_types"[0m
  [1m[36mBusinessType Load (1.4ms)[0m  [1m[34mSELECT  "business_types".* FROM "business_types" ORDER BY "business_types"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mBusinessType Load (0.8ms)[0m  [1m[34mSELECT  "business_types".* FROM "business_types" ORDER BY "business_types"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mIntegrationSystem Load (0.9ms)[0m  [1m[34mSELECT  "integration_systems".* FROM "integration_systems" ORDER BY "integration_systems"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddBusinessTypes (20200921200604)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[36mBusinessType Create (4.1ms)[0m  [1m[32mINSERT INTO "business_types" ("name", "id_name") VALUES ($1, $2) RETURNING "id"[0m  [["name", "{\"en\":\"default\",\"no\":\"default\"}"], ["id_name", "general"]]
  â†³ db/migrate/20200921200604_add_business_types.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200921200604"]]
  â†³ bin/rails:9
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
Migrating to AddIntegrationSystem (20200921203149)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[36mIntegrationSystem Create (1.1ms)[0m  [1m[32mINSERT INTO "integration_systems" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "manual"]]
  â†³ db/migrate/20200921203149_add_integration_system.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200921203149"]]
  â†³ bin/rails:9
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mSupplier Load (40.8ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplier Load (0.9ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mIntegrationSystem Load (0.5ms)[0m  [1m[34mSELECT  "integration_systems".* FROM "integration_systems" WHERE "integration_systems"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-22 00:49:59 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-22 00:50:00 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-22 00:50:00 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-22 00:50:00 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-22 00:50:00 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-22 00:50:00 +0400
Started GET "/en/suppliers/list" for 127.0.0.1 at 2020-09-22 00:50:09 +0400
Processing by SuppliersController#list as JSON
  Parameters: {"locale"=>"en", "id"=>"list"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplier Load (0.8ms)[0m  [1m[34mSELECT "suppliers".* FROM "suppliers" WHERE "suppliers"."active" = $1[0m  [["active", true]]
  â†³ app/services/suppliers/suppliers_service.rb:27
  [1m[36mIntegrationSystem Load (0.4ms)[0m  [1m[34mSELECT  "integration_systems".* FROM "integration_systems" WHERE "integration_systems"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:27
Completed 200 OK in 43ms (Views: 0.4ms | ActiveRecord: 13.2ms)


  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplier Load (0.8ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-22 10:36:14 +0400
  [1m[35m (2.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-22 10:36:14 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-22 10:36:14 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-22 10:36:14 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-22 10:36:15 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-22 10:36:15 +0400
Started GET "/en/suppliers/list" for 127.0.0.1 at 2020-09-22 10:36:26 +0400
Processing by SuppliersController#list as JSON
  Parameters: {"locale"=>"en", "id"=>"list"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplier Load (3.4ms)[0m  [1m[34mSELECT "suppliers".* FROM "suppliers" WHERE "suppliers"."active" = $1[0m  [["active", true]]
  â†³ app/services/suppliers/suppliers_service.rb:27
  [1m[36mIntegrationSystem Load (1.3ms)[0m  [1m[34mSELECT  "integration_systems".* FROM "integration_systems" WHERE "integration_systems"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:27
Completed 200 OK in 48ms (Views: 0.3ms | ActiveRecord: 24.6ms)


Started PUT "/en/supplier/3" for 127.0.0.1 at 2020-09-22 10:37:10 +0400
Processing by SuppliersController#update as JSON
  Parameters: {"active"=>false, "locale"=>"en", "id"=>"3", "supplier"=>{"active"=>false}}
Unpermitted parameters: :active, :format, :locale, :supplier
  [1m[36mSupplier Load (0.3ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:40
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/suppliers_service.rb:41
  [1m[36mIntegrationSystem Load (0.3ms)[0m  [1m[34mSELECT  "integration_systems".* FROM "integration_systems" WHERE "integration_systems"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:41
  [1m[36mBusinessType Load (2.2ms)[0m  [1m[34mSELECT  "business_types".* FROM "business_types" WHERE "business_types"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:41
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/suppliers_service.rb:41
Completed 200 OK in 26ms (Views: 0.2ms | ActiveRecord: 6.1ms)


Started GET "/en/suppliers/list" for 127.0.0.1 at 2020-09-22 10:37:17 +0400
Processing by SuppliersController#list as JSON
  Parameters: {"locale"=>"en", "id"=>"list"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplier Load (0.3ms)[0m  [1m[34mSELECT "suppliers".* FROM "suppliers" WHERE "suppliers"."active" = $1[0m  [["active", true]]
  â†³ app/services/suppliers/suppliers_service.rb:27
  [1m[36mIntegrationSystem Load (0.3ms)[0m  [1m[34mSELECT  "integration_systems".* FROM "integration_systems" WHERE "integration_systems"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:27
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.6ms)


Started PUT "/en/supplier/3" for 127.0.0.1 at 2020-09-22 10:37:48 +0400
Processing by SuppliersController#update as JSON
  Parameters: {"active"=>false, "locale"=>"en", "id"=>"3", "supplier"=>{"active"=>false}}
Unpermitted parameters: :format, :locale, :supplier
  [1m[36mSupplier Load (0.2ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:40
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/suppliers_service.rb:41
  [1m[36mIntegrationSystem Load (0.3ms)[0m  [1m[34mSELECT  "integration_systems".* FROM "integration_systems" WHERE "integration_systems"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:41
  [1m[36mBusinessType Load (0.3ms)[0m  [1m[34mSELECT  "business_types".* FROM "business_types" WHERE "business_types"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:41
  [1m[36mSupplier Update (2.4ms)[0m  [1m[33mUPDATE "suppliers" SET "active" = $1 WHERE "suppliers"."id" = $2[0m  [["active", false], ["id", 3]]
  â†³ app/services/suppliers/suppliers_service.rb:41
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/suppliers_service.rb:41
Completed 200 OK in 32ms (Views: 0.3ms | ActiveRecord: 12.3ms)


Started GET "/en/suppliers/list" for 127.0.0.1 at 2020-09-22 10:37:53 +0400
Processing by SuppliersController#list as JSON
  Parameters: {"locale"=>"en", "id"=>"list"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplier Load (0.3ms)[0m  [1m[34mSELECT "suppliers".* FROM "suppliers" WHERE "suppliers"."active" = $1[0m  [["active", true]]
  â†³ app/services/suppliers/suppliers_service.rb:27
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)


Started DELETE "/en/supplier/3" for 127.0.0.1 at 2020-09-22 10:42:32 +0400
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SuppliersController#destroy as JSON
  Parameters: {"locale"=>"en", "id"=>"3"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:47
Completed 500 Internal Server Error in 54ms (ActiveRecord: 4.6ms)


  
NoMethodError (undefined method `destroy' for nil:NilClass):
  
app/services/suppliers/suppliers_service.rb:48:in `destroy_supplier'
app/controllers/suppliers_controller.rb:27:in `destroy'
Started DELETE "/en/supplier/3" for 127.0.0.1 at 2020-09-22 10:42:43 +0400
Processing by SuppliersController#destroy as JSON
  Parameters: {"locale"=>"en", "id"=>"3"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplier Load (1.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ (pry):1
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/suppliers_service.rb:48
Completed 500 Internal Server Error in 17136ms (ActiveRecord: 12.5ms)


  
NoMethodError (undefined method `destroy' for nil:NilClass):
  
app/services/suppliers/suppliers_service.rb:49:in `destroy_supplier'
app/controllers/suppliers_controller.rb:27:in `destroy'
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-26 11:01:09 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-26 11:01:09 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-26 11:01:09 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-26 11:01:09 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-26 11:01:09 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-26 11:01:09 +0400
Started POST "/en/product_types" for 127.0.0.1 at 2020-09-26 11:01:23 +0400
Processing by ProductTypesController#create as JSON
  Parameters: {"name"=>{"no"=>"string", "en"=>"string"}, "active"=>true, "locale"=>"en", "product_type"=>{"name"=>{"no"=>"string", "en"=>"string"}, "active"=>true}}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 10ms (Views: 0.4ms | ActiveRecord: 10.2ms)


Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-26 11:01:43 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-26 11:01:43 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-26 11:01:43 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-26 11:01:43 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-26 11:01:44 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-26 11:01:44 +0400
Started POST "/en/product_types" for 127.0.0.1 at 2020-09-26 11:01:52 +0400
Processing by ProductTypesController#create as JSON
  Parameters: {"name"=>{"no"=>"string", "en"=>"string"}, "active"=>true, "locale"=>"en", "product_type"=>{"name"=>{"no"=>"string", "en"=>"string"}, "active"=>true}}
Unpermitted parameters: :format, :locale, :product_type
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_type_service.rb:29
  [1m[36mProductType Create (4.3ms)[0m  [1m[32mINSERT INTO "product_types" ("name", "id_name") VALUES ($1, $2) RETURNING "id"[0m  [["name", "{\"no\":\"string\",\"en\":\"string\"}"], ["id_name", "string"]]
  â†³ app/services/products/product_type_service.rb:29
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_type_service.rb:29
Completed 201 Created in 193ms (Views: 0.4ms | ActiveRecord: 12.1ms)


Started GET "/en/product_types/product_type_list" for 127.0.0.1 at 2020-09-26 11:02:20 +0400
Processing by ProductTypesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT "product_types".* FROM "product_types"[0m
  â†³ app/services/products/product_type_service.rb:23
Completed 200 OK in 14ms (Views: 0.4ms | ActiveRecord: 0.4ms)


Started GET "/en/products/list" for 127.0.0.1 at 2020-09-26 11:02:39 +0400
Processing by ProductsController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (7.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mSubCategory Load (2.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductType Load (0.5ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 11], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 13], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
Completed 200 OK in 145ms (Views: 1.1ms | ActiveRecord: 29.8ms)


Started GET "/en/products/product_vat_type" for 127.0.0.1 at 2020-09-26 11:03:10 +0400
Processing by ProductsController#product_vat_type as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProductVatType Load (3.6ms)[0m  [1m[34mSELECT "product_vat_types".* FROM "product_vat_types"[0m
  â†³ app/services/products/product_list_service.rb:25
Completed 200 OK in 19ms (Views: 0.5ms | ActiveRecord: 10.1ms)


  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-26 18:11:23 +0400
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-26 18:11:23 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-26 18:11:23 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-26 18:11:23 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-26 18:11:24 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-26 18:11:24 +0400
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCharacteristic Load (1.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" ORDER BY "product_characteristics"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCharacteristic Load (1.0ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" ORDER BY "product_characteristics"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCharacteristic Load (0.6ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" ORDER BY "product_characteristics"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddColumnsToProductCharacteristics (20200926145340)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (2.3ms)[0m  [1m[35mALTER TABLE "product_characteristic" ADD "subscription" boolean DEFAULT FALSE[0m
  â†³ db/migrate/20200926145340_add_columns_to_product_characteristics.rb:3
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.9ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddColumnsToProductCharacteristics (20200926145340)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (44.9ms)[0m  [1m[35mALTER TABLE "product_characteristics" ADD "subscription" boolean DEFAULT FALSE[0m
  â†³ db/migrate/20200926145340_add_columns_to_product_characteristics.rb:3
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "product_characteristics" ADD "commission" boolean DEFAULT FALSE[0m
  â†³ db/migrate/20200926145340_add_columns_to_product_characteristics.rb:4
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200926145340"]]
  â†³ bin/rails:9
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (2.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mProductCharacteristic Load (0.7ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" ORDER BY "product_characteristics"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[36mProductCharacteristic Load (0.8ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" ORDER BY "product_characteristics"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductType Load (1.4ms)[0m  [1m[34mSELECT "product_types".* FROM "product_types"[0m
Started POST "/en/products" for 127.0.0.1 at 2020-09-26 19:19:41 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by ProductsController#create as JSON
  Parameters: {"name"=>"buka", "full_name"=>"full buka", "description"=>"Test product", "code"=>"20569", "instruction"=>"Take cerfule with this product", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "shape"=>"some shape", "volume"=>"some volume", "packaging"=>"big", "manufacturer"=>"OSRAM", "description"=>"Good lights", "external_code"=>"232323", "sales_start"=>"30-09-2020", "sales_end"=>"30-12-2020", "EAN_code"=>"89665", "weight"=>24.3, "height"=>23.96, "width"=>78.3, "depth"=>5.3, "subscription"=>false, "commission"=>false}, "locale"=>"en", "product"=>{"name"=>"buka", "full_name"=>"full buka", "description"=>"Test product", "code"=>"20569", "instruction"=>"Take cerfule with this product", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "shape"=>"some shape", "volume"=>"some volume", "packaging"=>"big", "manufacturer"=>"OSRAM", "description"=>"Good lights", "external_code"=>"232323", "sales_start"=>"30-09-2020", "sales_end"=>"30-12-2020", "EAN_code"=>"89665", "weight"=>24.3, "height"=>23.96, "width"=>78.3, "depth"=>5.3, "subscription"=>false, "commission"=>false}}}
Unpermitted parameters: :name, :full_name, :format, :locale, :product
  [1m[36mProductType Load (0.8ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:41
  [1m[36mProductVatType Load (0.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:47
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_create_service.rb:59
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/products/product_create_service.rb:59
Completed 400 Bad Request in 3715ms (Views: 0.6ms | ActiveRecord: 26.6ms)


Started POST "/en/products" for 127.0.0.1 at 2020-09-26 19:20:23 +0400
Processing by ProductsController#create as JSON
  Parameters: {"name"=>{"en"=>"buka"}, "full_name"=>{"en"=>"full buka"}, "description"=>"Test product", "code"=>"20569", "instruction"=>"Take cerfule with this product", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "shape"=>"some shape", "volume"=>"some volume", "packaging"=>"big", "manufacturer"=>"OSRAM", "description"=>"Good lights", "external_code"=>"232323", "sales_start"=>"30-09-2020", "sales_end"=>"30-12-2020", "EAN_code"=>"89665", "weight"=>24.3, "height"=>23.96, "width"=>78.3, "depth"=>5.3, "subscription"=>false, "commission"=>false}, "locale"=>"en", "product"=>{"name"=>{"en"=>"buka"}, "full_name"=>{"en"=>"full buka"}, "description"=>"Test product", "code"=>"20569", "instruction"=>"Take cerfule with this product", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "shape"=>"some shape", "volume"=>"some volume", "packaging"=>"big", "manufacturer"=>"OSRAM", "description"=>"Good lights", "external_code"=>"232323", "sales_start"=>"30-09-2020", "sales_end"=>"30-12-2020", "EAN_code"=>"89665", "weight"=>24.3, "height"=>23.96, "width"=>78.3, "depth"=>5.3, "subscription"=>false, "commission"=>false}}}
Unpermitted parameters: :format, :locale, :product
  [1m[36mProductType Load (0.5ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:41
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:47
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_create_service.rb:59
  [1m[36mProduct Create (35.6ms)[0m  [1m[32mINSERT INTO "products" ("name", "full_name", "description", "code", "instruction") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "{\"en\":\"buka\"}"], ["full_name", "{\"en\":\"full buka\"}"], ["description", "Test product"], ["code", "20569"], ["instruction", "Take cerfule with this product"]]
  â†³ app/services/products/product_create_service.rb:59
  [1m[36mProductCharacteristic Create (2.2ms)[0m  [1m[32mINSERT INTO "product_characteristics" ("product_id", "sub_category_id", "shape", "volume", "packaging", "manufacturer", "description", "external_code", "sales_start", "sales_end", "EAN_code", "weight", "width", "height", "depth", "product_type_id", "product_vat_type_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17) RETURNING "id"[0m  [["product_id", 14], ["sub_category_id", 2], ["shape", "some shape"], ["volume", "some volume"], ["packaging", "big"], ["manufacturer", "OSRAM"], ["description", "Good lights"], ["external_code", "232323"], ["sales_start", "2020-09-30 00:00:00"], ["sales_end", "2020-12-30 00:00:00"], ["EAN_code", "89665"], ["weight", "24.3"], ["width", "78.3"], ["height", "23.96"], ["depth", "5.3"], ["product_type_id", 5], ["product_vat_type_id", 2]]
  â†³ app/services/products/product_create_service.rb:59
  [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_create_service.rb:59
  [1m[36mSubCategory Load (0.4ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:24
  [1m[36mProductType Load (0.6ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:24
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:24
Completed 201 Created in 6854ms (Views: 0.8ms | ActiveRecord: 52.7ms)


Started PUT "/en/product_types" for 127.0.0.1 at 2020-09-26 19:21:59 +0400
Processing by ProductTypesController#update as JSON
  Parameters: {"id"=>5, "name"=>{"no"=>"string_1", "en"=>"string_1"}, "id_name"=>"string_1", "active"=>true, "locale"=>"en", "product_type"=>{"id"=>5, "name"=>{"no"=>"string_1", "en"=>"string_1"}, "id_name"=>"string_1", "active"=>true}}
Unpermitted parameters: :id_name, :format, :locale, :product_type
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_type_service.rb:67
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_type_service.rb:39
  [1m[36mProductType Update (0.5ms)[0m  [1m[33mUPDATE "product_types" SET "name" = $1 WHERE "product_types"."id" = $2[0m  [["name", "{\"no\":\"string_1\",\"en\":\"string\"}"], ["id", 5]]
  â†³ app/services/products/product_type_service.rb:39
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_type_service.rb:39
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 3.4ms)


Started GET "/en/products/list" for 127.0.0.1 at 2020-09-26 19:22:12 +0400
Processing by ProductsController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mSubCategory Load (0.2ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.2ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.2ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 11], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mSubCategory Load (0.2ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 13], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.2ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 14], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductType Load (0.2ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
Completed 200 OK in 20ms (Views: 2.4ms | ActiveRecord: 2.9ms)


Started POST "/en/products" for 127.0.0.1 at 2020-09-26 19:32:36 +0400
Processing by ProductsController#create as JSON
  Parameters: {"name"=>{"en"=>"buka"}, "full_name"=>{"en"=>"full buka"}, "description"=>"Test product", "code"=>"20569", "instruction"=>"Take cerfule with this product", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "shape"=>"some shape", "volume"=>"some volume", "packaging"=>"big", "manufacturer"=>"OSRAM", "description"=>"Good lights", "external_code"=>"232323", "sales_start"=>"30-09-2020", "sales_end"=>"30-12-2020", "EAN_code"=>"89665", "weight"=>24.3, "height"=>23.96, "width"=>78.3, "depth"=>5.3, "subscription"=>false, "commission"=>false}, "locale"=>"en", "product"=>{"name"=>{"en"=>"buka"}, "full_name"=>{"en"=>"full buka"}, "description"=>"Test product", "code"=>"20569", "instruction"=>"Take cerfule with this product", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "shape"=>"some shape", "volume"=>"some volume", "packaging"=>"big", "manufacturer"=>"OSRAM", "description"=>"Good lights", "external_code"=>"232323", "sales_start"=>"30-09-2020", "sales_end"=>"30-12-2020", "EAN_code"=>"89665", "weight"=>24.3, "height"=>23.96, "width"=>78.3, "depth"=>5.3, "subscription"=>false, "commission"=>false}}}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 2ms (Views: 0.2ms | ActiveRecord: 8.6ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 00:14:03 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 00:14:03 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 00:14:03 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 00:14:03 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 00:14:04 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 00:14:04 +0400
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 00:14:22 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 00:14:22 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 00:14:22 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 00:14:22 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 00:14:22 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 00:14:22 +0400
Started GET "/en/product/id" for 127.0.0.1 at 2020-09-27 00:14:43 +0400
  
ActionController::RoutingError (No route matches [GET] "/en/product/id"):
  
actionpack (5.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `block in call'
chewy (5.1.0) lib/chewy/strategy.rb:70:in `wrap'
chewy (5.1.0) lib/chewy.rb:201:in `strategy'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `call'
railties (5.2.1) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
railties (5.2.1) lib/rails/engine.rb:524:in `call'
puma (3.12.0) lib/puma/configuration.rb:225:in `call'
puma (3.12.0) lib/puma/server.rb:658:in `handle_request'
puma (3.12.0) lib/puma/server.rb:472:in `process_client'
puma (3.12.0) lib/puma/server.rb:332:in `block in run'
puma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 00:19:04 +0400
  [1m[35m (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 00:19:04 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 00:19:04 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 00:19:04 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 00:19:04 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 00:19:04 +0400
Started GET "/en/product/edit_product" for 127.0.0.1 at 2020-09-27 00:19:19 +0400
  
ActionController::RoutingError (No route matches [GET] "/en/product/edit_product"):
  
actionpack (5.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `block in call'
chewy (5.1.0) lib/chewy/strategy.rb:70:in `wrap'
chewy (5.1.0) lib/chewy.rb:201:in `strategy'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `call'
railties (5.2.1) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
railties (5.2.1) lib/rails/engine.rb:524:in `call'
puma (3.12.0) lib/puma/configuration.rb:225:in `call'
puma (3.12.0) lib/puma/server.rb:658:in `handle_request'
puma (3.12.0) lib/puma/server.rb:472:in `process_client'
puma (3.12.0) lib/puma/server.rb:332:in `block in run'
puma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 00:19:58 +0400
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 00:19:58 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 00:19:58 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 00:19:58 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 00:19:58 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 00:19:58 +0400
Started GET "/en/products/edit_product" for 127.0.0.1 at 2020-09-27 00:20:08 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 7790ms (ActiveRecord: 7.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product without an ID):
  
app/services/products/product_update_service.rb:25:in `edit_product'
app/controllers/products_controller.rb:29:in `edit_product'
Started GET "/en/products/edit_product" for 127.0.0.1 at 2020-09-27 00:20:59 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 4830ms (ActiveRecord: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product without an ID):
  
app/services/products/product_update_service.rb:25:in `edit_product'
app/controllers/products_controller.rb:29:in `edit_product'
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/en/products/edit_product" for 127.0.0.1 at 2020-09-27 00:21:23 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 6030ms (ActiveRecord: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product without an ID):
  
app/services/products/product_update_service.rb:25:in `edit_product'
app/controllers/products_controller.rb:29:in `edit_product'
Started GET "/en/products/edit_product" for 127.0.0.1 at 2020-09-27 00:21:39 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 18750ms (ActiveRecord: 3.7ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product without an ID):
  
app/services/products/product_update_service.rb:26:in `edit_product'
app/controllers/products_controller.rb:29:in `edit_product'
Started GET "/en/products/edit_product" for 127.0.0.1 at 2020-09-27 00:22:09 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 38208ms (ActiveRecord: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product without an ID):
  
app/services/products/product_update_service.rb:26:in `edit_product'
app/controllers/products_controller.rb:29:in `edit_product'
Started GET "/en/products/edit_product" for 127.0.0.1 at 2020-09-27 00:22:50 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 5793ms (ActiveRecord: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product without an ID):
  
app/services/products/product_update_service.rb:26:in `edit_product'
app/controllers/products_controller.rb:29:in `edit_product'
Started GET "/en/products/edit_product" for 127.0.0.1 at 2020-09-27 00:22:59 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 404 Not Found in 7913ms (ActiveRecord: 0.0ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product without an ID):
  
app/services/products/product_update_service.rb:26:in `edit_product'
app/controllers/products_controller.rb:29:in `edit_product'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 00:23:31 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 00:23:31 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 00:23:31 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 00:23:31 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 00:23:31 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 00:23:31 +0400
Started GET "/en/products/edit_product?id=14" for 127.0.0.1 at 2020-09-27 00:23:41 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"14", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:26
Completed 500 Internal Server Error in 6715ms (ActiveRecord: 11.2ms)


  
NameError (undefined local variable or method `product_characteristics_schema' for #<Products::ProductUpdateService:0x00007efc4001b290>):
  
app/services/products/product_update_service.rb:15:in `json_view'
lib/controller_response.rb:30:in `respond_json_view'
lib/controller_response.rb:43:in `rest_response_body'
lib/controller_response.rb:8:in `rest_respond_service'
app/controllers/products_controller.rb:30:in `edit_product'
Started GET "/en/products/edit_product?id=14" for 127.0.0.1 at 2020-09-27 00:24:19 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"14", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
Completed 500 Internal Server Error in 21638ms (ActiveRecord: 4.1ms)


  
NameError (undefined local variable or method `product_characteristics_schema' for #<Products::ProductUpdateService:0x00007efc38027ed0>):
  
app/services/products/product_update_service.rb:16:in `json_view'
lib/controller_response.rb:30:in `respond_json_view'
lib/controller_response.rb:43:in `rest_response_body'
lib/controller_response.rb:8:in `rest_respond_service'
app/controllers/products_controller.rb:30:in `edit_product'
Started GET "/en/products/edit_product?id=14" for 127.0.0.1 at 2020-09-27 00:25:36 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"14", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 14], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.3ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 5593ms (Views: 0.4ms | ActiveRecord: 26.4ms)


  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" ORDER BY "product_characteristics"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to RemoveColumnsFromProductCharacteristics (20200926203704)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (41.8ms)[0m  [1m[35mALTER TABLE "product_characteristics" DROP COLUMN "shape"[0m
  â†³ db/migrate/20200926203704_remove_columns_from_product_characteristics.rb:3
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "product_characteristics" DROP COLUMN "packing"[0m
  â†³ db/migrate/20200926203704_remove_columns_from_product_characteristics.rb:4
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to RemoveColumnsFromProductCharacteristics (20200926203704)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "product_characteristics" DROP COLUMN "shape"[0m
  â†³ db/migrate/20200926203704_remove_columns_from_product_characteristics.rb:3
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "product_characteristics" DROP COLUMN "packaging"[0m
  â†³ db/migrate/20200926203704_remove_columns_from_product_characteristics.rb:4
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "product_characteristics" DROP COLUMN "sales_start"[0m
  â†³ db/migrate/20200926203704_remove_columns_from_product_characteristics.rb:5
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "product_characteristics" DROP COLUMN "sales_end"[0m
  â†³ db/migrate/20200926203704_remove_columns_from_product_characteristics.rb:6
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200926203704"]]
  â†³ bin/rails:9
  [1m[35m (32.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 00:51:27 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 00:51:27 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 00:51:27 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 00:51:27 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 00:51:28 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 00:51:28 +0400
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateCurrencies (20200926205812)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (26.0ms)[0m  [1m[35mCREATE TABLE "currencies" ("id" bigserial primary key, "name" json NOT NULL, "symbol" character varying(20) NOT NULL, "code" character varying(3) NOT NULL)[0m
  â†³ db/migrate/20200926205812_create_currencies.rb:3
  [1m[35m (2.6ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_currencies_on_code" ON "currencies"  ("code")[0m
  â†³ db/migrate/20200926205812_create_currencies.rb:9
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200926205812"]]
  â†³ bin/rails:9
  [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to FillCurrencies (20200926210103)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[36mCurrency Create (0.7ms)[0m  [1m[32mINSERT INTO "currencies" ("name", "symbol", "code") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "\"Krone\""], ["symbol", "â€ŽKR"], ["code", "nok"]]
  â†³ db/migrate/20200926210103_fill_currencies.rb:3
  [1m[36mCurrency Create (0.2ms)[0m  [1m[32mINSERT INTO "currencies" ("name", "symbol", "code") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "\"USD dollar\""], ["symbol", "$"], ["code", "usd"]]
  â†³ db/migrate/20200926210103_fill_currencies.rb:4
  [1m[36mCurrency Create (0.4ms)[0m  [1m[32mINSERT INTO "currencies" ("name", "symbol", "code") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "\"Euro\""], ["symbol", "â‚¬"], ["code", "euro"]]
  â†³ db/migrate/20200926210103_fill_currencies.rb:5
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to FillCurrencies (20200926210103)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[36mCurrency Create (0.5ms)[0m  [1m[32mINSERT INTO "currencies" ("name", "symbol", "code") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "\"Krone\""], ["symbol", "â€ŽKR"], ["code", "nok"]]
  â†³ db/migrate/20200926210103_fill_currencies.rb:3
  [1m[36mCurrency Create (0.3ms)[0m  [1m[32mINSERT INTO "currencies" ("name", "symbol", "code") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "\"USD dollar\""], ["symbol", "$"], ["code", "usd"]]
  â†³ db/migrate/20200926210103_fill_currencies.rb:4
  [1m[36mCurrency Create (0.2ms)[0m  [1m[32mINSERT INTO "currencies" ("name", "symbol", "code") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "\"Euro\""], ["symbol", "â‚¬"], ["code", "eur"]]
  â†³ db/migrate/20200926210103_fill_currencies.rb:5
  [1m[36mActiveRecord::SchemaMigration Create (2.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200926210103"]]
  â†³ bin/rails:9
  [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 01:26:51 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 01:26:51 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 01:26:51 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 01:26:51 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 01:26:51 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 01:26:51 +0400
Started GET "/en/currencies/currencies_list" for 127.0.0.1 at 2020-09-27 01:26:57 +0400
Processing by CurrenciesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 204 No Content in 3ms (Views: 0.1ms | ActiveRecord: 0.0ms)


Started GET "/en/currencies/currencies_list" for 127.0.0.1 at 2020-09-27 01:27:30 +0400
Processing by CurrenciesController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCurrency Load (0.6ms)[0m  [1m[34mSELECT "currencies".* FROM "currencies"[0m
  â†³ app/services/general/currencies_service.rb:14
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 5.6ms)


  [1m[36mSupplierProduct Load (1.7ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddQuantityColumnToSupplierProducts (20200927103709)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "supplier_products" ADD "quantity" integer[0m
  â†³ db/migrate/20200927103709_add_quantity_column_to_supplier_products.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200927103709"]]
  â†³ bin/rails:9
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to RemoveMinSellAmountColumnFromSupplierProduct (20200927104129)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "supplier_products" DROP COLUMN "min_sell_amount"[0m
  â†³ db/migrate/20200927104129_remove_min_sell_amount_column_from_supplier_product.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200927104129"]]
  â†³ bin/rails:9
  [1m[35m (36.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 18:53:16 +0400
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 18:53:16 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 18:53:16 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 18:53:16 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 18:53:16 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 18:53:16 +0400
Started GET "/en/sub_categories/sub_category_list?category_id=1" for 127.0.0.1 at 2020-09-27 18:58:43 +0400
Processing by SubCategoriesController#list as JSON
  Parameters: {"category_id"=>"1", "locale"=>"en"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms)


Started GET "/en/sub_categories/sub_category_list?category_id=1" for 127.0.0.1 at 2020-09-27 18:59:05 +0400
Processing by SubCategoriesController#list as JSON
  Parameters: {"category_id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSubCategory Load (0.8ms)[0m  [1m[34mSELECT "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."category_id" = $1[0m  [["category_id", 1]]
  â†³ app/services/category_sub_categories/sub_categories_service.rb:22
Completed 200 OK in 29ms (Views: 0.3ms | ActiveRecord: 9.9ms)


Started POST "/en/products" for 127.0.0.1 at 2020-09-27 19:00:01 +0400
Processing by ProductsController#create as JSON
  Parameters: {"name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "full_name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "description"=>"kaia kata", "code"=>"986532", "instruction"=>"You should take care about it", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "volume"=>"askja", "manufacturer"=>"Oslo", "description"=>"dasdasd", "external_code"=>"030201", "sales_start"=>"as", "sales_end"=>"striascng", "EAN_code"=>"string", "weight"=>23, "height"=>23, "width"=>23, "depth"=>23, "subscription"=>true, "commission"=>true}, "locale"=>"en", "product"=>{"name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "full_name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "description"=>"kaia kata", "code"=>"986532", "instruction"=>"You should take care about it", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "volume"=>"askja", "manufacturer"=>"Oslo", "description"=>"dasdasd", "external_code"=>"030201", "sales_start"=>"as", "sales_end"=>"striascng", "EAN_code"=>"string", "weight"=>23, "height"=>23, "width"=>23, "depth"=>23, "subscription"=>true, "commission"=>true}}}
Unpermitted parameters: :format, :locale, :product
  [1m[36mProductType Load (1.1ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:40
  [1m[36mProductVatType Load (0.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:46
Completed 500 Internal Server Error in 93ms (ActiveRecord: 20.0ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'sales_start' for ProductCharacteristic.):
  
app/services/products/product_create_service.rb:57:in `create_product_item'
app/services/products/product_create_service.rb:18:in `create_product'
app/controllers/products_controller.rb:16:in `create'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 19:02:45 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 19:02:45 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 19:02:45 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 19:02:45 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 19:02:45 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 19:02:46 +0400
Started POST "/en/products" for 127.0.0.1 at 2020-09-27 19:03:08 +0400
Processing by ProductsController#create as JSON
  Parameters: {"name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "full_name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "description"=>"kaia kata", "code"=>"986532", "instruction"=>"You should take care about it", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "volume"=>"askja", "manufacturer"=>"Oslo", "description"=>"dasdasd", "external_code"=>"030201", "EAN_code"=>"string", "weight"=>23, "height"=>23, "width"=>23, "depth"=>23, "subscription"=>true, "commission"=>true}, "locale"=>"en", "product"=>{"name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "full_name"=>{"en"=>"test_product", "no"=>"test_product_no"}, "description"=>"kaia kata", "code"=>"986532", "instruction"=>"You should take care about it", "product_characteristic_attributes"=>{"sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "volume"=>"askja", "manufacturer"=>"Oslo", "description"=>"dasdasd", "external_code"=>"030201", "EAN_code"=>"string", "weight"=>23, "height"=>23, "width"=>23, "depth"=>23, "subscription"=>true, "commission"=>true}}}
Unpermitted parameters: :format, :locale, :product
  [1m[36mProductType Load (1.0ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:40
  [1m[36mProductVatType Load (0.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:46
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_create_service.rb:58
  [1m[36mProduct Create (2.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "full_name", "description", "code", "instruction") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "{\"en\":\"test_product\",\"no\":\"test_product_no\"}"], ["full_name", "{\"en\":\"test_product\",\"no\":\"test_product_no\"}"], ["description", "kaia kata"], ["code", "986532"], ["instruction", "You should take care about it"]]
  â†³ app/services/products/product_create_service.rb:58
  [1m[36mProductCharacteristic Create (2.6ms)[0m  [1m[32mINSERT INTO "product_characteristics" ("product_id", "sub_category_id", "volume", "manufacturer", "description", "external_code", "EAN_code", "weight", "width", "height", "depth", "product_type_id", "product_vat_type_id", "subscription", "commission") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["product_id", 15], ["sub_category_id", 2], ["volume", "askja"], ["manufacturer", "Oslo"], ["description", "dasdasd"], ["external_code", "030201"], ["EAN_code", "string"], ["weight", "23.0"], ["width", "23.0"], ["height", "23.0"], ["depth", "23.0"], ["product_type_id", 5], ["product_vat_type_id", 2], ["subscription", true], ["commission", true]]
  â†³ app/services/products/product_create_service.rb:58
  [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_create_service.rb:58
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:23
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:23
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_create_service.rb:23
Completed 201 Created in 46ms (Views: 0.5ms | ActiveRecord: 10.2ms)


  [1m[36mSupplierProduct Load (0.7ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 19:41:06 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 19:41:06 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 19:41:06 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 19:41:06 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 19:41:07 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 19:41:08 +0400
  [1m[36mSupplierProductPrice Load (2.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" ORDER BY "supplier_product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to RemoveAndAddColumnsFroCurrency (20200927155250)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "supplier_product_prices" DROP COLUMN "currency"[0m
  â†³ db/migrate/20200927155250_remove_and_add_columns_fro_currency.rb:3
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "supplier_product_prices" ADD CONSTRAINT "fk_rails_298846d27d"
FOREIGN KEY ("currency_id")
  REFERENCES "currencies" ("id")
[0m
  â†³ db/migrate/20200927155250_remove_and_add_columns_fro_currency.rb:4
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to RemoveAndAddColumnsFroCurrency (20200927155250)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (1.5ms)[0m  [1m[35mALTER TABLE "supplier_product_prices" DROP COLUMN "currency"[0m
  â†³ db/migrate/20200927155250_remove_and_add_columns_fro_currency.rb:3
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "supplier_product_prices" ADD "currency_id" integer[0m
  â†³ db/migrate/20200927155250_remove_and_add_columns_fro_currency.rb:4
  [1m[35m (16.2ms)[0m  [1m[35mALTER TABLE "supplier_product_prices" ADD CONSTRAINT "fk_rails_298846d27d"
FOREIGN KEY ("currency_id")
  REFERENCES "currencies" ("id")
[0m
  â†³ db/migrate/20200927155250_remove_and_add_columns_fro_currency.rb:5
  [1m[35m (6.8ms)[0m  [1m[35mCREATE  INDEX  "supplier_product_prices_currency" ON "supplier_product_prices"  ("currency_id")[0m
  â†³ db/migrate/20200927155250_remove_and_add_columns_fro_currency.rb:6
  [1m[36mActiveRecord::SchemaMigration Create (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200927155250"]]
  â†³ bin/rails:9
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mSupplierProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" ORDER BY "supplier_product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" ORDER BY "supplier_product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 22:23:38 +0400
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 22:23:38 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 22:23:38 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 22:23:38 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 22:23:39 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 22:23:39 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 22:26:02 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 22:26:02 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 22:26:02 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 22:26:02 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 22:26:03 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 22:26:03 +0400
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-27 22:27:19 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-27 22:27:19 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-27 22:27:19 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-27 22:27:19 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-27 22:27:19 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-27 22:27:19 +0400
  [1m[36mSupplier Load (8.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCurrency Load (0.4ms)[0m  [1m[34mSELECT  "currencies".* FROM "currencies" ORDER BY "currencies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:29:14 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 5.3ms)


  
NameError (uninitialized constant Supplier::SupplierProductsService):
  
app/controllers/supplier_products_controller.rb:9:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:29:44 +0400
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Completed 500 Internal Server Error in 4ms (ActiveRecord: 2.8ms)


  
NameError (uninitialized constant Supplier::SupplierProductsService):
  
app/controllers/supplier_products_controller.rb:9:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:31:26 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms)


  
NameError (uninitialized constant Supplier::SupplierProductsService):
  
app/controllers/supplier_products_controller.rb:9:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:37:45 +0400
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Completed 500 Internal Server Error in 5491ms (ActiveRecord: 2.7ms)


  
LoadError (Unable to autoload constant Suppliers::SupplierProductsService, expected /home/buka/always24/app/services/suppliers/supplier_products_service.rb to define it):
  
app/controllers/supplier_products_controller.rb:10:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:38:20 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (1.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:54
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:59
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:49
Completed 500 Internal Server Error in 24567ms (ActiveRecord: 28.2ms)


  
NoMethodError (undefined method `provider_id' for #<SupplierProduct:0x00007f238c0e6c38>):
  
app/services/suppliers/supplier_products_service.rb:49:in `create_item'
app/services/suppliers/supplier_products_service.rb:15:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:39:36 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.7ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:54
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:59
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:49
Completed 500 Internal Server Error in 3502ms (ActiveRecord: 21.6ms)


  
NoMethodError (undefined method `med_code' for #<SupplierProduct:0x00007f238cb1f808>):
  
app/services/suppliers/supplier_products_service.rb:49:in `create_item'
app/services/suppliers/supplier_products_service.rb:15:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:40:03 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:54
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:59
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:49
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:49
Completed 500 Internal Server Error in 5683ms (ActiveRecord: 25.6ms)


  
NoMethodError (undefined method `errors' for nil:NilClass):
  
lib/errors_format.rb:22:in `fill_errors'
app/services/suppliers/supplier_products_service.rb:50:in `create_item'
app/services/suppliers/supplier_products_service.rb:15:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:40:34 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
Completed 500 Internal Server Error in 10697ms (ActiveRecord: 2.1ms)


  
NameError (undefined local variable or method `validate_data' for #<Suppliers::SupplierProductsService:0x00007f238cf0bc28>
Did you mean?  validate_data!):
  
app/services/suppliers/supplier_products_service.rb:15:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:41:30 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (1.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:56
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:61
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:51
Completed 500 Internal Server Error in 4587ms (ActiveRecord: 25.8ms)


  
NoMethodError (undefined method `errors' for nil:NilClass):
  
lib/errors_format.rb:22:in `fill_errors'
app/services/suppliers/supplier_products_service.rb:52:in `create_item'
app/services/suppliers/supplier_products_service.rb:17:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:41:39 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.8ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:56
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:61
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:51
Completed 500 Internal Server Error in 5694ms (ActiveRecord: 2.5ms)


  
NoMethodError (undefined method `errors' for nil:NilClass):
  
lib/errors_format.rb:22:in `fill_errors'
app/services/suppliers/supplier_products_service.rb:52:in `create_item'
app/services/suppliers/supplier_products_service.rb:17:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:42:29 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.9ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:58
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:63
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:53
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:53
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:53
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:53
Completed 400 Bad Request in 7303ms (Views: 0.3ms | ActiveRecord: 27.6ms)


Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-27 22:43:26 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"code_001", "quantity"=>15, "supplier_product_price_attributes"=>{"price"=>23.6, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.6ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:57
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:62
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):2
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):2
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ (pry):2
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):2
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):3
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):3
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):9
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):11
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):11
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):12
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):12
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):13
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):14
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):14
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):15
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):15
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):16
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):16
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:52
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:52
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:52
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:52
Completed 400 Bad Request in 640618ms (Views: 0.7ms | ActiveRecord: 35.9ms)


Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-29 20:57:28 +0400
  [1m[35m (1.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-29 20:57:28 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-29 20:57:28 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-29 20:57:28 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-29 20:57:29 +0400
Started GET "/en/products/edit_product?id=7" for 127.0.0.1 at 2020-09-29 20:57:59 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"7", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (2.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
Completed 404 Not Found in 560499ms (ActiveRecord: 30.2ms)


  
ActiveRecord::RecordNotFound (Couldn't find Product with 'id'=7):
  
app/services/products/product_update_service.rb:27:in `edit_product'
app/controllers/products_controller.rb:28:in `edit_product'
  [1m[36mProduct Load (3.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:10:58 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (7.8ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (1.7ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (1.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (1.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 11878ms (Views: 0.5ms | ActiveRecord: 35.8ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:11:49 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.5ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 33263ms (Views: 0.4ms | ActiveRecord: 29.6ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:12:25 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.6ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.2ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.3ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 9754ms (Views: 0.3ms | ActiveRecord: 23.2ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:12:44 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.5ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.3ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 7122ms (Views: 0.5ms | ActiveRecord: 2.3ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:12:54 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.4ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.3ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 4379ms (Views: 0.3ms | ActiveRecord: 2.1ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:13:10 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.3ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 6926ms (Views: 0.4ms | ActiveRecord: 1.8ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:13:23 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.4ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 1135690ms (Views: 0.4ms | ActiveRecord: 25.1ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:34:50 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 7410ms (Views: 0.7ms | ActiveRecord: 24.6ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:35:29 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 500 Internal Server Error in 5283ms (ActiveRecord: 0.0ms)


  
ArgumentError (wrong number of arguments (given 2, expected 1)):
  
config/initializers/multilanguage.rb:2:in `multilanguage'
app/models/product.rb:4:in `<class:Product>'
app/models/product.rb:1:in `<main>'
app/services/products/product_update_service.rb:29:in `edit_product'
app/controllers/products_controller.rb:28:in `edit_product'
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:38:30 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 500 Internal Server Error in 11537ms (ActiveRecord: 5.5ms)


  
NoMethodError (undefined method `edit_action?' for #<Class:0x0000560d80459438>):
  
app/models/product.rb:4:in `<class:Product>'
app/models/product.rb:1:in `<main>'
app/services/products/product_update_service.rb:29:in `edit_product'
app/controllers/products_controller.rb:28:in `edit_product'
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:39:10 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 500 Internal Server Error in 89044ms (ActiveRecord: 0.0ms)


  
NoMethodError (undefined method `edit_action?' for #<Class:0x00007f91d008e3c8>):
  
app/models/product.rb:4:in `<class:Product>'
app/models/product.rb:1:in `<main>'
app/services/products/product_update_service.rb:29:in `edit_product'
app/controllers/products_controller.rb:28:in `edit_product'
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:40:47 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 500 Internal Server Error in 4767ms (ActiveRecord: 3.8ms)


  
NameError (undefined local variable or method `action' for #<Class:0x00007f91bc5a4470>):
  
app/models/product.rb:4:in `<class:Product>'
app/models/product.rb:1:in `<main>'
app/services/products/product_update_service.rb:29:in `edit_product'
app/controllers/products_controller.rb:28:in `edit_product'
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:41:07 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 500 Internal Server Error in 22954ms (ActiveRecord: 0.0ms)


  
NameError (undefined local variable or method `action' for #<Class:0x00007f91c89ca818>):
  
app/models/product.rb:4:in `<class:Product>'
app/models/product.rb:1:in `<main>'
app/services/products/product_update_service.rb:29:in `edit_product'
app/controllers/products_controller.rb:28:in `edit_product'
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:46:48 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 500 Internal Server Error in 6799ms (ActiveRecord: 0.0ms)


  
NameError (undefined local variable or method `action' for #<Class:0x00007f91d0773328>):
  
app/models/product.rb:4:in `<class:Product>'
app/models/product.rb:1:in `<main>'
app/services/products/product_update_service.rb:29:in `edit_product'
app/controllers/products_controller.rb:28:in `edit_product'
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:47:07 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.2ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 9704ms (Views: 0.5ms | ActiveRecord: 27.8ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:47:25 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.7ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.6ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.5ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 13602ms (Views: 0.9ms | ActiveRecord: 2.8ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:47:47 +0400
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:29
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mSubCategory Load (0.7ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductType Load (0.5ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
  [1m[36mProductVatType Load (0.7ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:18
Completed 200 OK in 95586ms (Views: 0.8ms | ActiveRecord: 28.3ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:52:41 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (0.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.4ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 8423ms (Views: 0.5ms | ActiveRecord: 23.9ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:53:16 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.2ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.2ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.3ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:53:23 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.3ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.5ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:53:24 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (0.3ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (0.2ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.2ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.3ms)


Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 21:53:26 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (0.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.3ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (0.3ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 1.8ms)


  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCharacteristic Load (0.7ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  [1m[36mProductType Load (1.0ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mProductVatType Load (0.3ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mSubCategory Load (1.1ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mCategory Load (1.6ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 22:00:30 +0400
  [1m[35m (1.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:27
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.4ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.5ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 173ms (Views: 0.4ms | ActiveRecord: 32.5ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-29 22:07:57 +0400
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-29 22:07:57 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-29 22:07:57 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-29 22:07:57 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-29 22:07:57 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-29 22:07:58 +0400
Started GET "/en/products/edit_product?id=15" for 127.0.0.1 at 2020-09-29 22:08:16 +0400
Processing by ProductsController#edit_product as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 34ms (Views: 0.4ms | ActiveRecord: 0.0ms)


  [1m[36mSupplier Load (7.3ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:24:10 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.7ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:60
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):2
  [1m[36mCACHE Supplier Load (0.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):2
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ (pry):2
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):2
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:50
Completed 400 Bad Request in 100695ms (Views: 0.5ms | ActiveRecord: 41.7ms)


Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:28:53 +0400
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.6ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:65
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:70
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:51
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:51
Completed 400 Bad Request in 81168ms (Views: 0.7ms | ActiveRecord: 22.1ms)


Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:30:18 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.9ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:69
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:74
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mSupplierProduct Create (9.1ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-09-29 18:30:23.809969"], ["updated_at", "2020-09-29 18:30:23.809969"], ["quantity", 23]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
Completed 400 Bad Request in 30850ms (Views: 0.4ms | ActiveRecord: 45.4ms)


Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:31:08 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:69
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:74
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mSupplierProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-09-29 18:31:13.905474"], ["updated_at", "2020-09-29 18:31:13.905474"], ["quantity", 23]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (4.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProductPrice Create (9.0ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 2], ["price", "25.0"], ["created_at", "2020-09-29 18:31:14.486813"], ["updated_at", "2020-09-29 18:31:14.486813"], ["currency_id", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
Completed 500 Internal Server Error in 5875ms (ActiveRecord: 33.2ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  insert or update on table "supplier_product_prices" violates foreign key constraint "fk_rails_298846d27d"
DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
: INSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"):
  
app/services/suppliers/supplier_products_service.rb:64:in `create_price'
app/services/suppliers/supplier_products_service.rb:16:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:31:21 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.8ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:69
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:74
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mSupplierProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-09-29 18:31:25.041458"], ["updated_at", "2020-09-29 18:31:25.041458"], ["quantity", 23]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (4.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProduct Load (0.7ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProductPrice Create (2.2ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 3], ["price", "25.0"], ["created_at", "2020-09-29 18:32:58.753978"], ["updated_at", "2020-09-29 18:32:58.753978"], ["currency_id", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
Completed 500 Internal Server Error in 96857ms (ActiveRecord: 10.4ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  insert or update on table "supplier_product_prices" violates foreign key constraint "fk_rails_298846d27d"
DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
: INSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"):
  
app/services/suppliers/supplier_products_service.rb:64:in `create_price'
app/services/suppliers/supplier_products_service.rb:16:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:33:02 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:69
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:74
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mSupplierProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-09-29 18:33:05.503843"], ["updated_at", "2020-09-29 18:33:05.503843"], ["quantity", 23]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProduct Load (0.5ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProductPrice Create (1.3ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 4], ["price", "25.0"], ["created_at", "2020-09-29 18:33:09.752482"], ["updated_at", "2020-09-29 18:33:09.752482"], ["currency_id", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
Completed 500 Internal Server Error in 7656ms (ActiveRecord: 7.6ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  insert or update on table "supplier_product_prices" violates foreign key constraint "fk_rails_298846d27d"
DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
: INSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"):
  
app/services/suppliers/supplier_products_service.rb:64:in `create_price'
app/services/suppliers/supplier_products_service.rb:16:in `create_supplier_product'
app/controllers/supplier_products_controller.rb:11:in `create'
  [1m[36mCurrency Load (1.2ms)[0m  [1m[34mSELECT  "currencies".* FROM "currencies" ORDER BY "currencies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCurrency Load (0.4ms)[0m  [1m[34mSELECT "currencies".* FROM "currencies"[0m
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:33:35 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (1.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:69
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:74
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[36mSupplierProduct Create (0.6ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-09-29 18:33:39.503367"], ["updated_at", "2020-09-29 18:33:39.503367"], ["quantity", 23]]
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:55
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[36mSupplierProductPrice Create (0.8ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 5], ["price", "25.0"], ["created_at", "2020-09-29 18:33:40.229638"], ["updated_at", "2020-09-29 18:33:40.229638"], ["currency_id", 3]]
  â†³ app/services/suppliers/supplier_products_service.rb:64
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:64
Completed 204 No Content in 5074ms (Views: 0.3ms | ActiveRecord: 8.4ms)


Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:36:26 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>4}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>4}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:70
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:75
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:15
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:57
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:57
  [1m[36mSupplierProduct Create (0.7ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-09-29 18:36:34.424650"], ["updated_at", "2020-09-29 18:36:34.424650"], ["quantity", 23]]
  â†³ app/services/suppliers/supplier_products_service.rb:57
  [1m[36mSupplierProduct Load (0.6ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:65
  [1m[36mSupplierProductPrice Create (1.2ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 6], ["price", "25.0"], ["created_at", "2020-09-29 18:36:34.450011"], ["updated_at", "2020-09-29 18:36:34.450011"], ["currency_id", 4]]
  â†³ app/services/suppliers/supplier_products_service.rb:65
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:15
Completed 204 No Content in 7818ms (Views: 0.2ms | ActiveRecord: 28.7ms)


  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-29 22:42:32 +0400
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-29 22:42:32 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-29 22:42:32 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-29 22:42:32 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-29 22:42:33 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-29 22:42:33 +0400
Started POST "/en/supplier_products" for 127.0.0.1 at 2020-09-29 22:42:50 +0400
Processing by SupplierProductsController#create as JSON
  Parameters: {"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>5}, "locale"=>"en", "supplier_product"=>{"supplier_id"=>4, "product_id"=>15, "supplier_code"=>"0055", "quantity"=>23, "supplier_product_price_attributes"=>{"price"=>25, "currency_id"=>5}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplier Load (1.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:74
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:79
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:19
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:61
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:61
  [1m[36mSupplierProduct Create (1.1ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-09-29 18:42:58.324208"], ["updated_at", "2020-09-29 18:42:58.324208"], ["quantity", 23]]
  â†³ app/services/suppliers/supplier_products_service.rb:61
  [1m[36mSupplierProduct Load (0.6ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:69
  [1m[36mSupplierProductPrice Create (1.3ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 7], ["price", "25.0"], ["created_at", "2020-09-29 18:42:58.357730"], ["updated_at", "2020-09-29 18:42:58.357730"], ["currency_id", 5]]
  â†³ app/services/suppliers/supplier_products_service.rb:69
  [1m[35m (14.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:19
Completed 201 Created in 8025ms (Views: 0.2ms | ActiveRecord: 49.7ms)


Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 00:34:18 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 00:34:18 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 00:34:18 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 00:34:18 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 00:34:18 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 00:34:18 +0400
Started DELETE "/en/products?id=15" for 127.0.0.1 at 2020-09-30 00:34:31 +0400
Processing by ProductsController#destroy as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms)


Started DELETE "/en/products?id=15" for 127.0.0.1 at 2020-09-30 00:35:04 +0400
Processing by ProductsController#destroy as JSON
  Parameters: {"id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_destroy_service.rb:20
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_destroy_service.rb:21
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_destroy_service.rb:21
  [1m[36mProductCharacteristic Destroy (0.6ms)[0m  [1m[31mDELETE FROM "product_characteristics" WHERE "product_characteristics"."id" = $1[0m  [["id", 21]]
  â†³ app/services/products/product_destroy_service.rb:21
  [1m[36mProductImage Load (5.3ms)[0m  [1m[34mSELECT "product_images".* FROM "product_images" WHERE "product_images"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_destroy_service.rb:21
  [1m[36mProduct Destroy (2.7ms)[0m  [1m[31mDELETE FROM "products" WHERE "products"."id" = $1[0m  [["id", 15]]
  â†³ app/services/products/product_destroy_service.rb:21
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/products/product_destroy_service.rb:21
Completed 500 Internal Server Error in 16390ms (ActiveRecord: 28.5ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "products" violates foreign key constraint "fk_rails_9a363579c5" on table "supplier_products"
DETAIL:  Key (id)=(15) is still referenced from table "supplier_products".
: DELETE FROM "products" WHERE "products"."id" = $1):
  
app/services/products/product_destroy_service.rb:21:in `destroy_product'
app/controllers/products_controller.rb:34:in `destroy'
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddActiveColumnToProduct (20200929203713)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (4.7ms)[0m  [1m[35mALTER TABLE "products" ADD "active" boolean DEFAULT TRUE[0m
  â†³ db/migrate/20200929203713_add_active_column_to_product.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200929203713"]]
  â†³ bin/rails:9
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
Started DELETE "/en/products?id=2" for 127.0.0.1 at 2020-09-30 00:39:43 +0400
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by ProductsController#destroy as JSON
  Parameters: {"id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_destroy_service.rb:20
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_destroy_service.rb:22
  [1m[36mProduct Update (0.8ms)[0m  [1m[33mUPDATE "products" SET "active" = $1 WHERE "products"."id" = $2[0m  [["active", false], ["id", 2]]
  â†³ app/services/products/product_destroy_service.rb:22
  [1m[35m (36.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_destroy_service.rb:22
Completed 200 OK in 21999ms (Views: 0.2ms | ActiveRecord: 46.2ms)


  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCharacteristic Load (0.9ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 2], ["LIMIT", 1]]
  [1m[36mProduct Load (1.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCharacteristic Load (1.1ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
Started PUT "/en/products" for 127.0.0.1 at 2020-09-30 00:46:46 +0400
Processing by ProductsController#update as JSON
  Parameters: {"id"=>2, "name"=>{"en"=>"changed name"}, "full_name"=>{"en"=>"changed full name"}, "description"=>"changed description", "instruction"=>"changed instruction", "code"=>"02020202", "product_characteristic_attributes"=>{"id"=>2, "sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "volume"=>"54", "manufacturer"=>"OSLAM", "description"=>"changed description", "external_code"=>"989898", "EAN_code"=>"25639", "weight"=>23, "height"=>23, "width"=>23, "depth"=>23, "subscription"=>true, "commission"=>true}, "locale"=>"en", "product"=>{"id"=>2, "name"=>{"en"=>"changed name"}, "full_name"=>{"en"=>"changed full name"}, "description"=>"changed description", "code"=>"02020202", "instruction"=>"changed instruction", "product_characteristic_attributes"=>{"id"=>2, "sub_category_id"=>2, "product_type_id"=>5, "product_vat_type_id"=>2, "volume"=>"54", "manufacturer"=>"OSLAM", "description"=>"changed description", "external_code"=>"989898", "EAN_code"=>"25639", "weight"=>23, "height"=>23, "width"=>23, "depth"=>23, "subscription"=>true, "commission"=>true}}}
Unpermitted parameters: :format, :locale, :product
  [1m[36mProduct Load (1.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ (pry):5
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):6
  [1m[36mProductCharacteristic Load (0.9ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 2], ["LIMIT", 1]]
  â†³ (pry):6
  [1m[36mProductCharacteristic Destroy (0.6ms)[0m  [1m[31mDELETE FROM "product_characteristics" WHERE "product_characteristics"."id" = $1[0m  [["id", 2]]
  â†³ (pry):6
  [1m[36mProduct Update (38.2ms)[0m  [1m[33mUPDATE "products" SET "name" = $1, "full_name" = $2, "description" = $3, "code" = $4, "instruction" = $5 WHERE "products"."id" = $6[0m  [["name", "{\"en\":\"changed name\"}"], ["full_name", "{\"en\":\"changed full name\"}"], ["description", "changed description"], ["code", "02020202"], ["instruction", "changed instruction"], ["id", 2]]
  â†³ (pry):6
  [1m[36mProductCharacteristic Create (6.4ms)[0m  [1m[32mINSERT INTO "product_characteristics" ("product_id", "sub_category_id", "volume", "manufacturer", "description", "external_code", "EAN_code", "weight", "width", "height", "depth", "product_type_id", "product_vat_type_id", "subscription", "commission") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["product_id", 2], ["sub_category_id", 2], ["volume", "54"], ["manufacturer", "OSLAM"], ["description", "changed description"], ["external_code", "989898"], ["EAN_code", "25639"], ["weight", "23.0"], ["width", "23.0"], ["height", "23.0"], ["depth", "23.0"], ["product_type_id", 5], ["product_vat_type_id", 2], ["subscription", true], ["commission", true]]
  â†³ (pry):6
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ (pry):6
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:22
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_update_service.rb:23
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:23
  [1m[36mProductCharacteristic Destroy (0.5ms)[0m  [1m[31mDELETE FROM "product_characteristics" WHERE "product_characteristics"."id" = $1[0m  [["id", 22]]
  â†³ app/services/products/product_update_service.rb:23
  [1m[36mProductCharacteristic Create (0.7ms)[0m  [1m[32mINSERT INTO "product_characteristics" ("product_id", "sub_category_id", "volume", "manufacturer", "description", "external_code", "EAN_code", "weight", "width", "height", "depth", "product_type_id", "product_vat_type_id", "subscription", "commission") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["product_id", 2], ["sub_category_id", 2], ["volume", "54"], ["manufacturer", "OSLAM"], ["description", "changed description"], ["external_code", "989898"], ["EAN_code", "25639"], ["weight", "23.0"], ["width", "23.0"], ["height", "23.0"], ["depth", "23.0"], ["product_type_id", 5], ["product_vat_type_id", 2], ["subscription", true], ["commission", true]]
  â†³ app/services/products/product_update_service.rb:23
  [1m[35m (36.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_update_service.rb:23
  [1m[36mProductType Load (0.4ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mProductVatType Load (0.6ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mSubCategory Load (0.4ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
  [1m[36mCategory Load (0.4ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_update_service.rb:17
Completed 200 OK in 111426ms (Views: 3.2ms | ActiveRecord: 128.3ms)


Started GET "/en/products/list" for 127.0.0.1 at 2020-09-30 00:53:30 +0400
Processing by ProductsController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."active" = $1[0m  [["active", true]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.6ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductType Load (0.5ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mSubCategory Load (0.4ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCategory Load (0.3ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.7ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 11], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mSubCategory Load (0.5ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE Category Load (0.0ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 13], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE Category Load (0.0ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 14], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductType Load (0.5ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductVatType Load (0.5ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE Category Load (0.0ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mProductCharacteristic Load (0.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE ProductType Load (0.0ms)[0m  [1m[34mSELECT  "product_types".* FROM "product_types" WHERE "product_types"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE ProductVatType Load (0.0ms)[0m  [1m[34mSELECT  "product_vat_types".* FROM "product_vat_types" WHERE "product_vat_types"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE SubCategory Load (0.0ms)[0m  [1m[34mSELECT  "sub_categories".* FROM "sub_categories" WHERE "sub_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
  [1m[36mCACHE Category Load (0.0ms)[0m  [1m[34mSELECT  "categories".* FROM "categories" WHERE "categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/products/product_list_service.rb:17
Completed 200 OK in 148ms (Views: 1.3ms | ActiveRecord: 32.9ms)


Started GET "/en/suppliers/list" for 127.0.0.1 at 2020-09-30 00:55:20 +0400
Processing by SuppliersController#list as JSON
  Parameters: {"locale"=>"en", "id"=>"list"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms)


Started GET "/en/suppliers/list" for 127.0.0.1 at 2020-09-30 00:56:00 +0400
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SuppliersController#list as JSON
  Parameters: {"locale"=>"en", "id"=>"list"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 2ms (Views: 0.3ms | ActiveRecord: 0.0ms)


  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCharacteristic Load (0.5ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" WHERE "product_characteristics"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  [1m[36mSupplierProduct Load (1.2ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 01:21:27 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 01:21:27 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 01:21:27 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 01:21:27 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 01:21:28 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 01:21:28 +0400
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 01:22:24 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 01:22:24 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 01:22:24 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 01:22:24 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 01:22:24 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 01:22:24 +0400
  [1m[36mSupplierProduct Load (1.1ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProductPrice Load (1.1ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 01:32:25 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 01:32:25 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 01:32:25 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 01:32:25 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 01:32:26 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 01:32:26 +0400
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:33:14 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :id, :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (1.6ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):2
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
Completed 500 Internal Server Error in 31036ms (ActiveRecord: 4.7ms)


  
NameError (undefined local variable or method `supplier' for #<Suppliers::SupplierProductsService:0x00007f26f807cd00>
Did you mean?  super):
  
app/services/suppliers/supplier_products_service.rb:51:in `find_supplier_product'
app/services/suppliers/supplier_products_service.rb:32:in `update_supplier_product'
app/controllers/supplier_products_controller.rb:16:in `update'
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:34:06 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:34:07 +0400
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
Completed 500 Internal Server Error in 7575ms (ActiveRecord: 9.4ms)


  
NameError (undefined local variable or method `supplier' for #<Suppliers::SupplierProductsService:0x00007f26f42ec6c0>
Did you mean?  super):
  
app/services/suppliers/supplier_products_service.rb:51:in `find_supplier_product'
app/services/suppliers/supplier_products_service.rb:32:in `update_supplier_product'
app/controllers/supplier_products_controller.rb:16:in `update'
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ (pry):5
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ (pry):6
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
Completed 500 Internal Server Error in 36960ms (ActiveRecord: 7.6ms)


  
NameError (undefined local variable or method `supplier' for #<Suppliers::SupplierProductsService:0x00007f2708270f20>
Did you mean?  super):
  
app/services/suppliers/supplier_products_service.rb:51:in `find_supplier_product'
app/services/suppliers/supplier_products_service.rb:32:in `update_supplier_product'
app/controllers/supplier_products_controller.rb:16:in `update'
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:34:55 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.5ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
Completed 500 Internal Server Error in 36445ms (ActiveRecord: 0.5ms)


  
NameError (undefined local variable or method `supplier' for #<Suppliers::SupplierProductsService:0x00007f26f8127458>
Did you mean?  super):
  
app/services/suppliers/supplier_products_service.rb:51:in `find_supplier_product'
app/services/suppliers/supplier_products_service.rb:32:in `update_supplier_product'
app/controllers/supplier_products_controller.rb:16:in `update'
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:35:35 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Load (0.3ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Destroy (0.4ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 6]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 400 Bad Request in 6854ms (Views: 0.6ms | ActiveRecord: 15.5ms)


Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:35:53 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ (pry):9
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):10
  [1m[36mSupplierProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ (pry):10
  [1m[36mSupplierProductPrice Destroy (1.2ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 6]]
  â†³ (pry):10
  [1m[36mSupplier Load (0.9ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):10
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ (pry):10
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):10
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):11
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):11
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Load (0.4ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Destroy (0.3ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 6]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.2ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 400 Bad Request in 84839ms (Views: 0.2ms | ActiveRecord: 7.3ms)


Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:37:21 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.2ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Load (0.2ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Destroy (0.4ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 6]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.3ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 400 Bad Request in 17206ms (Views: 0.2ms | ActiveRecord: 13.7ms)


Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:37:51 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Load (0.4ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.3ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 400 Bad Request in 4491ms (Views: 0.2ms | ActiveRecord: 20.8ms)


Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:38:02 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.7ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ (pry):18
  [1m[36mCACHE SupplierProduct Load (0.1ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ (pry):19
  [1m[36mSupplierProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ (pry):19
  [1m[36mCACHE SupplierProduct Load (0.1ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mCACHE SupplierProductPrice Load (0.0ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.7ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 400 Bad Request in 90420ms (Views: 0.8ms | ActiveRecord: 4.1ms)


Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:40:19 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>3, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.7ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):21
  [1m[36mSupplierProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ (pry):21
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):21
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ (pry):21
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):21
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ (pry):23
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ (pry):23
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ (pry):25
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):26
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ (pry):27
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  â†³ (pry):28
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ (pry):29
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ (pry):30
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Load (0.2ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.3ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 400 Bad Request in 61223ms (Views: 0.1ms | ActiveRecord: 8.5ms)


Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:41:28 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>1}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.2ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Load (0.1ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProduct Update (0.5ms)[0m  [1m[33mUPDATE "supplier_products" SET "product_id" = $1, "supplier_code" = $2, "quantity" = $3, "updated_at" = $4 WHERE "supplier_products"."id" = $5[0m  [["product_id", 2], ["supplier_code", "0066"], ["quantity", 20], ["updated_at", "2020-09-29 21:41:33.961357"], ["id", 7]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Update (0.7ms)[0m  [1m[33mUPDATE "supplier_product_prices" SET "price" = $1, "currency_id" = $2, "updated_at" = $3 WHERE "supplier_product_prices"."id" = $4[0m  [["price", "20.0"], ["currency_id", 1], ["updated_at", "2020-09-29 21:41:33.962833"], ["id", 6]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 500 Internal Server Error in 5556ms (ActiveRecord: 2.1ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  insert or update on table "supplier_product_prices" violates foreign key constraint "fk_rails_298846d27d"
DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
: UPDATE "supplier_product_prices" SET "price" = $1, "currency_id" = $2, "updated_at" = $3 WHERE "supplier_product_prices"."id" = $4):
  
app/services/suppliers/supplier_products_service.rb:33:in `update_supplier_product'
app/controllers/supplier_products_controller.rb:17:in `update'
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:41:47 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:50
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Load (0.2ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplier Load (0.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProduct Update (0.4ms)[0m  [1m[33mUPDATE "supplier_products" SET "product_id" = $1, "supplier_code" = $2, "quantity" = $3, "updated_at" = $4 WHERE "supplier_products"."id" = $5[0m  [["product_id", 2], ["supplier_code", "0066"], ["quantity", 20], ["updated_at", "2020-09-29 21:41:52.336022"], ["id", 7]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[36mSupplierProductPrice Update (0.4ms)[0m  [1m[33mUPDATE "supplier_product_prices" SET "price" = $1, "currency_id" = $2, "updated_at" = $3 WHERE "supplier_product_prices"."id" = $4[0m  [["price", "20.0"], ["currency_id", 3], ["updated_at", "2020-09-29 21:41:52.337401"], ["id", 6]]
  â†³ app/services/suppliers/supplier_products_service.rb:33
  [1m[35m (35.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:33
Completed 200 OK in 5354ms (Views: 0.3ms | ActiveRecord: 37.6ms)


  [1m[36mSupplierProductPrice Load (0.7ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" ORDER BY "supplier_product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:46:04 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:53
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[36mSupplierProductPrice Load (0.2ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[36mSupplier Load (0.2ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:36
Completed 500 Internal Server Error in 9796ms (ActiveRecord: 15.1ms)


  
NoMethodError (undefined method `currency' for #<SupplierProductPrice:0x00007f26f4497650>
Did you mean?  currency_id):
  
app/services/suppliers/supplier_products_service.rb:18:in `update_json_view'
lib/controller_response.rb:22:in `respond_action_json_view'
lib/controller_response.rb:41:in `rest_response_body'
lib/controller_response.rb:8:in `rest_respond_service'
app/controllers/supplier_products_controller.rb:18:in `update'
Started PUT "/en/supplier_products" for 127.0.0.1 at 2020-09-30 01:46:49 +0400
Processing by SupplierProductsController#update as JSON
  Parameters: {"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>3}, "locale"=>"en", "supplier_product"=>{"id"=>7, "supplier_id"=>4, "product_id"=>2, "supplier_code"=>"0066", "quantity"=>20, "supplier_product_price_attributes"=>{"id"=>6, "price"=>20, "currency_id"=>3}}}
Unpermitted parameters: :format, :locale, :supplier_product
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:53
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[36mSupplierProductPrice Load (0.2ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[36mSupplier Load (0.2ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[36mCurrency Load (0.2ms)[0m  [1m[34mSELECT  "currencies".* FROM "currencies" WHERE "currencies"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:36
Completed 200 OK in 4524ms (Views: 0.3ms | ActiveRecord: 18.7ms)


Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 01:47:19 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 01:47:19 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 01:47:19 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 01:47:19 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 01:47:20 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 01:47:20 +0400
  [1m[36mSupplierProduct Load (0.5ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 01:50:14 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 01:50:14 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 01:50:14 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 01:50:14 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 01:50:14 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 01:50:14 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 01:55:05 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 01:55:05 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 01:55:05 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 01:55:05 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 01:55:06 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 01:55:06 +0400
Started DELETE "/en/supplier_products?id=7" for 127.0.0.1 at 2020-09-30 01:55:19 +0400
Processing by SupplierProductsController#destroy as JSON
  Parameters: {"id"=>"7", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (0.6ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:54
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:47
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:47
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:47
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:47
Completed 200 OK in 47ms (Views: 0.2ms | ActiveRecord: 12.5ms)


  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products"[0m
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started DELETE "/en/supplier_products?id=7" for 127.0.0.1 at 2020-09-30 01:56:04 +0400
Processing by SupplierProductsController#destroy as JSON
  Parameters: {"id"=>"7", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:54
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/suppliers/supplier_products_service.rb:47
  [1m[36mSupplier Load (0.3ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:47
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:47
  [1m[36mSupplierProduct Update (0.4ms)[0m  [1m[33mUPDATE "supplier_products" SET "is_active" = $1, "updated_at" = $2 WHERE "supplier_products"."id" = $3[0m  [["is_active", true], ["updated_at", "2020-09-29 21:56:04.520817"], ["id", 7]]
  â†³ app/services/suppliers/supplier_products_service.rb:47
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/suppliers/supplier_products_service.rb:47
Completed 200 OK in 49ms (Views: 0.2ms | ActiveRecord: 13.8ms)


  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to ChangeColumnDefaultValue (20200929215700)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to ChangeColumnDefaultValue (20200929215700)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (39.6ms)[0m  [1m[35mALTER TABLE "supplier_products" ALTER COLUMN "is_active" TYPE boolean, ALTER COLUMN "is_active" SET DEFAULT TRUE[0m
  â†³ db/migrate/20200929215700_change_column_default_value.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20200929215700"]]
  â†³ bin/rails:9
  [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 16:56:42 +0400
  [1m[35m (1.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 16:56:43 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 16:56:43 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 16:56:43 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 16:56:43 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 16:56:43 +0400
  [1m[36mSupplierProduct Load (6.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-09-30 17:31:00 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-09-30 17:31:00 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-09-30 17:31:00 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-09-30 17:31:00 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-09-30 17:31:01 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-09-30 17:31:01 +0400
Started GET "/en/supplier_products/list" for 127.0.0.1 at 2020-09-30 17:31:13 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"locale"=>"en"}
Filter chain halted as :validate_authentication rendered or redirected
Completed 401 Unauthorized in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms)


Started GET "/en/supplier_products/list" for 127.0.0.1 at 2020-09-30 17:31:27 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (0.6ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."is_active" = $1[0m  [["is_active", true]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
  [1m[36mProduct Load (4.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
  [1m[36mSupplierProductPrice Load (2.3ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
  [1m[36mCurrency Load (1.6ms)[0m  [1m[34mSELECT  "currencies".* FROM "currencies" WHERE "currencies"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
Completed 200 OK in 84ms (Views: 0.3ms | ActiveRecord: 24.8ms)


  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-01 19:04:43 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-01 19:04:43 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-01 19:04:43 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-01 19:04:43 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-01 19:04:44 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-01 19:04:44 +0400
Started GET "/en/supplier_products/list?supplier_id=2" for 127.0.0.1 at 2020-10-01 19:05:18 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"supplier_id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (3.6ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."supplier_id" = $1 AND "supplier_products"."is_active" = $2[0m  [["supplier_id", 2], ["is_active", true]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 16.7ms)


Started GET "/en/supplier_products/list?supplier_id=5" for 127.0.0.1 at 2020-10-01 19:05:25 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"supplier_id"=>"5", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."supplier_id" = $1 AND "supplier_products"."is_active" = $2[0m  [["supplier_id", 5], ["is_active", true]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
Completed 200 OK in 3ms (Views: 0.2ms | ActiveRecord: 0.4ms)


Started GET "/en/supplier_products/list?supplier_id=1" for 127.0.0.1 at 2020-10-01 19:05:31 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"supplier_id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (0.5ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."supplier_id" = $1 AND "supplier_products"."is_active" = $2[0m  [["supplier_id", 1], ["is_active", true]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
Completed 200 OK in 3ms (Views: 0.2ms | ActiveRecord: 0.5ms)


Started GET "/en/supplier_products/list?supplier_id=2" for 127.0.0.1 at 2020-10-01 19:05:36 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"supplier_id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."supplier_id" = $1 AND "supplier_products"."is_active" = $2[0m  [["supplier_id", 2], ["is_active", true]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)


Started GET "/en/supplier_products/list?supplier_id=3" for 127.0.0.1 at 2020-10-01 19:05:42 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"supplier_id"=>"3", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (0.6ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."supplier_id" = $1 AND "supplier_products"."is_active" = $2[0m  [["supplier_id", 3], ["is_active", true]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.6ms)


Started GET "/en/supplier_products/list?supplier_id=4" for 127.0.0.1 at 2020-10-01 19:05:46 +0400
Processing by SupplierProductsController#list as JSON
  Parameters: {"supplier_id"=>"4", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mSupplierProduct Load (35.9ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."supplier_id" = $1 AND "supplier_products"."is_active" = $2[0m  [["supplier_id", 4], ["is_active", true]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
  [1m[36mProduct Load (3.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
  [1m[36mSupplierProductPrice Load (2.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
  [1m[36mCurrency Load (2.1ms)[0m  [1m[34mSELECT  "currencies".* FROM "currencies" WHERE "currencies"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/suppliers/supplier_products_service.rb:25
Completed 200 OK in 165ms (Views: 0.4ms | ActiveRecord: 73.9ms)


  [1m[36mProductCharacteristic Load (3.4ms)[0m  [1m[34mSELECT  "product_characteristics".* FROM "product_characteristics" ORDER BY "product_characteristics"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (38.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateProductPrices (20201001214457)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (21.4ms)[0m  [1m[35mCREATE TABLE "product_prices" ("id" bigserial primary key, "product_id" bigint NOT NULL, "list_price_type" character varying(30) NOT NULL, "list_price_amount" decimal NOT NULL, "manufacturing_cost" decimal NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, CONSTRAINT "fk_rails_e7ec0c97a3"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  â†³ db/migrate/20201001214457_create_product_prices.rb:3
  [1m[35m (104.0ms)[0m  [1m[35mCREATE  INDEX  "index_product_prices_on_product_id" ON "product_prices"  ("product_id")[0m
  â†³ db/migrate/20201001214457_create_product_prices.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201001214457"]]
  â†³ bin/rails:9
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductPrice Load (1.7ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (37.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 01:54:59 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 01:55:00 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 01:55:00 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 01:55:00 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 01:55:00 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 01:55:00 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 01:56:35 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 01:56:35 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 01:56:35 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 01:56:35 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 01:56:35 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 01:56:35 +0400
  [1m[36mProduct Load (3.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 01:57:56 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 6.6ms)


  
NameError (uninitialized constant Products::ProductsPrice):
  
app/controllers/product_prices_controller.rb:9:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 02:00:21 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 1.7ms)


  
NameError (uninitialized constant Products::ProductsPriceService):
  
app/controllers/product_prices_controller.rb:9:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 02:00:45 +0400
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300}}
Completed 500 Internal Server Error in 56042ms (ActiveRecord: 2.4ms)


  
NameError (uninitialized constant Products::ProductsPriceService):
  
app/controllers/product_prices_controller.rb:10:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 02:01:46 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:22
  [1m[36mProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:27
Completed 500 Internal Server Error in 5612ms (ActiveRecord: 13.2ms)


  
NameError (undefined local variable or method `params' for #<Products::ProductPriceService:0x00007ff884174fd8>):
  
app/services/products/product_price_service.rb:28:in `first_or_initialize_price'
app/services/products/product_price_service.rb:15:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 02:02:54 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:22
  [1m[36mProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:27
Completed 500 Internal Server Error in 108091ms (ActiveRecord: 1.7ms)


  
NameError (undefined local variable or method `params' for #<Products::ProductPriceService:0x00007ff8700ebb98>):
  
app/services/products/product_price_service.rb:28:in `first_or_initialize_price'
app/services/products/product_price_service.rb:15:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 02:05:13 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>200, "manufacturing_cost"=>300}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:25
  [1m[36mProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:30
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:31
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:31
  [1m[36mProductPrice Create (6.4ms)[0m  [1m[32mINSERT INTO "product_prices" ("product_id", "list_price_type", "list_price_amount", "manufacturing_cost", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["product_id", 15], ["list_price_type", "fix_price"], ["list_price_amount", "200.0"], ["manufacturing_cost", "300.0"], ["created_at", "2020-10-02 22:05:39.266495"], ["updated_at", "2020-10-02 22:05:39.266495"]]
  â†³ app/services/products/product_price_service.rb:31
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:31
  [1m[36mProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):4
  [1m[36mCACHE ProductPrice Load (0.0ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):13
Completed 204 No Content in 2954989ms (Views: 0.2ms | ActiveRecord: 28.2ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 02:54:50 +0400
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 02:54:50 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 02:54:50 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 02:54:50 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 02:54:51 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 02:54:51 +0400
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 02:56:01 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 02:56:01 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 02:56:01 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 02:56:01 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 02:56:02 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 02:56:02 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 02:57:19 +0400
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 02:57:19 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 02:57:19 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 02:57:19 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 02:57:19 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 02:57:20 +0400
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 03:05:38 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>50, "manufacturing_cost"=>200, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>50, "manufacturing_cost"=>200}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:30
  [1m[36mProductPrice Load (0.7ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:36
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:36
  [1m[36mProductPrice Update (0.8ms)[0m  [1m[33mUPDATE "product_prices" SET "list_price_type" = $1, "list_price_amount" = $2, "manufacturing_cost" = $3, "updated_at" = $4 WHERE "product_prices"."id" = $5[0m  [["list_price_type", "percent"], ["list_price_amount", "50.0"], ["manufacturing_cost", "200.0"], ["updated_at", "2020-10-02 23:05:45.999521"], ["id", 1]]
  â†³ app/services/products/product_price_service.rb:36
  [1m[35m (4.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:36
Completed 500 Internal Server Error in 7591ms (ActiveRecord: 18.4ms)


  
ActiveRecord::ConfigurationError (Can't join 'ProductPrice' to association named 'products'; perhaps you misspelled it?):
  
app/services/products/product_price_service.rb:53:in `calculation'
app/services/products/product_price_service.rb:20:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
  [1m[36mProductPrice Load (2.7ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductPrice Load (4.4ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" INNER JOIN "supplier_products" ON "supplier_products"."product_id" = "products"."id" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductPrice Load (1.6ms)[0m  [1m[34mSELECT "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" INNER JOIN "supplier_products" ON "supplier_products"."product_id" = "products"."id"[0m
  [1m[36mProductPrice Load (1.3ms)[0m  [1m[34mSELECT "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id"[0m
  [1m[36mProductPrice Load (1.8ms)[0m  [1m[34mSELECT "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN sipplier_products on supplier_products.product_id = products.id[0m
  [1m[36mProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN sipplier_products on supplier_products.product_id = products.id LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mProductPrice Load (1.6ms)[0m  [1m[34mSELECT "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN sipplier_products on supplier_products.product_id == products.id[0m
  [1m[36mProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN sipplier_products on supplier_products.product_id == products.id LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mProductPrice Load (1.4ms)[0m  [1m[34mSELECT "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN supplier_products on supplier_products.product_id == products.id[0m
  [1m[36mProductPrice Load (1.1ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN supplier_products on supplier_products.product_id == products.id LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mProductPrice Load (1.5ms)[0m  [1m[34mSELECT "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN supplier_products on supplier_products.product_id = products.id[0m
  [1m[36mProductPrice Load (40.5ms)[0m  [1m[34mSELECT "product_prices".* FROM "product_prices" INNER JOIN "products" ON "products"."id" = "product_prices"."product_id" LEFT JOIN supplier_products on supplier_products.product_id = products.id LEFT JOIN supplier_product_prices as prices ON prices.supplier_product_id = supplier_products.id[0m
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 17:23:30 +0400
  [1m[35m (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 17:23:31 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 17:23:31 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 17:23:31 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 17:23:31 +0400
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 17:24:47 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 17:24:47 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 17:24:47 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 17:24:47 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 17:24:48 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 17:24:48 +0400
  [1m[36mSupplierProduct Load (4.6ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (1.2ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProductPrice Load (6.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 7], ["LIMIT", 1]]
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplier Load (14.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" ORDER BY "suppliers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:36:51 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (3.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (39.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mProductPrice Update (1.9ms)[0m  [1m[33mUPDATE "product_prices" SET "list_price_amount" = $1, "manufacturing_cost" = $2, "updated_at" = $3 WHERE "product_prices"."id" = $4[0m  [["list_price_amount", "20.0"], ["manufacturing_cost", "100.0"], ["updated_at", "2020-10-03 13:36:59.298049"], ["id", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.1ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:42
  [1m[36mCACHE SupplierProduct Load (0.1ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
Completed 500 Internal Server Error in 36351ms (ActiveRecord: 72.5ms)


  
NoMethodError (undefined method `[]' for nil:NilClass):
  
app/services/products/product_price_service.rb:56:in `set_prices'
app/services/products/product_price_service.rb:47:in `block in calculation'
app/services/products/product_price_service.rb:46:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products"[0m
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  [1m[35m (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1 ORDER BY "supplier_products"."id" DESC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 5]]
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1 ORDER BY "supplier_products"."id" DESC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 5]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1 ORDER BY "supplier_products"."id" DESC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 5]]
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 1], ["LIMIT", 1]]
  [1m[36mSupplierProduct Destroy (1.4ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 1]]
  [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mSupplierProduct Load (0.5ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.3ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 2], ["LIMIT", 1]]
  [1m[36mSupplierProduct Destroy (0.6ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 2]]
  [1m[35m (36.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 3], ["LIMIT", 1]]
  [1m[36mSupplierProduct Destroy (1.0ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 3]]
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 4], ["LIMIT", 1]]
  [1m[36mSupplierProduct Destroy (0.3ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 4]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.7ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 5], ["LIMIT", 1]]
  [1m[36mSupplierProductPrice Destroy (1.1ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 4]]
  [1m[36mSupplierProduct Destroy (1.1ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 5]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 6], ["LIMIT", 1]]
  [1m[36mSupplierProductPrice Destroy (0.8ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 5]]
  [1m[36mSupplierProduct Destroy (1.0ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 6]]
  [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplier Load (0.2ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mSupplierProduct Create (15.9ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-10-03 13:39:22.038753"], ["updated_at", "2020-10-03 13:39:22.038753"]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplier Load (0.2ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mSupplierProduct Create (0.3ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 4], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-10-03 13:39:49.181275"], ["updated_at", "2020-10-03 13:39:49.181275"], ["quantity", 50]]
  [1m[35m (35.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "supplier_products"[0m
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1 OFFSET $2[0m  [["LIMIT", 1], ["OFFSET", 1]]
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" ASC LIMIT $1 OFFSET $2[0m  [["LIMIT", 1], ["OFFSET", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 8], ["LIMIT", 1]]
  [1m[36mSupplierProduct Destroy (0.9ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 8]]
  [1m[35m (36.1ms)[0m  [1m[35mCOMMIT[0m
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:41:13 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.4ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.5ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
Completed 500 Internal Server Error in 22971ms (ActiveRecord: 4.1ms)


  
NoMethodError (undefined method `[]' for nil:NilClass):
  
app/services/products/product_price_service.rb:56:in `set_prices'
app/services/products/product_price_service.rb:47:in `block in calculation'
app/services/products/product_price_service.rb:46:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:41:51 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (1.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.0ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.1ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
Completed 500 Internal Server Error in 166368ms (ActiveRecord: 4.3ms)


  
NoMethodError (undefined method `[]' for nil:NilClass):
  
app/services/products/product_price_service.rb:56:in `set_prices'
app/services/products/product_price_service.rb:47:in `block in calculation'
app/services/products/product_price_service.rb:46:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:44:40 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:42
  [1m[36mCACHE SupplierProduct Load (0.0ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (1.4ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ (pry):11
Completed 500 Internal Server Error in 109857ms (ActiveRecord: 26.2ms)


  
NoMethodError (undefined method `price' for nil:NilClass):
  
app/services/products/product_price_service.rb:56:in `set_prices'
app/services/products/product_price_service.rb:47:in `block in calculation'
app/services/products/product_price_service.rb:46:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProduct Load (1.1ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mSupplierProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:47:53 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.1ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.9ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ (pry):19
Completed 500 Internal Server Error in 32510ms (ActiveRecord: 4.6ms)


  
NoMethodError (undefined method `price' for nil:NilClass):
  
app/services/products/product_price_service.rb:56:in `set_prices'
app/services/products/product_price_service.rb:47:in `block in calculation'
app/services/products/product_price_service.rb:46:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:48:39 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.4ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.1ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ (pry):22
Completed 500 Internal Server Error in 34184ms (ActiveRecord: 36.3ms)


  
TypeError (nil can't be coerced into BigDecimal):
  
app/services/products/product_price_service.rb:56:in `+'
app/services/products/product_price_service.rb:56:in `set_prices'
app/services/products/product_price_service.rb:47:in `block in calculation'
app/services/products/product_price_service.rb:46:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:49:47 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.3ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ (pry):26
  [1m[36mSupplier Load (1.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):28
  [1m[36mCACHE Supplier Load (0.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):29
  [1m[36mCACHE Supplier Load (0.0ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ (pry):30
  [1m[36mCACHE Supplier Load (0.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
Completed 500 Internal Server Error in 95853ms (ActiveRecord: 42.2ms)


  
NoMethodError (undefined method `price' for nil:NilClass):
  
app/services/products/product_price_service.rb:60:in `set_prices'
app/services/products/product_price_service.rb:47:in `block in calculation'
app/services/products/product_price_service.rb:46:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:51:40 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (0.9ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:56
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
Completed 201 Created in 6253ms (Views: 0.2ms | ActiveRecord: 46.7ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:52:14 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.6ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (1.0ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:57
  [1m[36mSupplier Load (0.9ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:59
Completed 201 Created in 5499ms (Views: 0.3ms | ActiveRecord: 47.6ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:52:52 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.2ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.7ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.6ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 17115ms (Views: 0.7ms | ActiveRecord: 41.0ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:53:29 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (0.9ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.8ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 5493ms (Views: 0.8ms | ActiveRecord: 44.1ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:54:34 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>20, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.1ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (1.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 5635ms (Views: 0.6ms | ActiveRecord: 49.2ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:55:07 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>30, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>30, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.0ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mProductPrice Update (1.1ms)[0m  [1m[33mUPDATE "product_prices" SET "list_price_type" = $1, "list_price_amount" = $2, "updated_at" = $3 WHERE "product_prices"."id" = $4[0m  [["list_price_type", "fix_price"], ["list_price_amount", "30.0"], ["updated_at", "2020-10-03 13:55:11.519251"], ["id", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (36.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 6674ms (Views: 0.5ms | ActiveRecord: 41.8ms)


  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCurrency Load (6.4ms)[0m  [1m[34mSELECT "currencies".* FROM "currencies"[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mCurrency Load (0.7ms)[0m  [1m[34mSELECT  "currencies".* FROM "currencies" WHERE "currencies"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mSupplierProductPrice Create (36.0ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 9], ["price", "100.0"], ["created_at", "2020-10-03 13:56:43.059730"], ["updated_at", "2020-10-03 13:56:43.059730"], ["currency_id", 3]]
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:56:46 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>30, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"fix_price", "list_price_amount"=>30, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.8ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.1ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.7ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.7ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 6836ms (Views: 0.7ms | ActiveRecord: 10.4ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:57:11 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>100, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>100}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.0ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mProductPrice Update (0.8ms)[0m  [1m[33mUPDATE "product_prices" SET "list_price_type" = $1, "updated_at" = $2 WHERE "product_prices"."id" = $3[0m  [["list_price_type", "percent"], ["updated_at", "2020-10-03 13:57:13.857079"], ["id", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (36.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.9ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 4621ms (Views: 0.6ms | ActiveRecord: 41.4ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:57:26 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.0ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mProductPrice Update (1.1ms)[0m  [1m[33mUPDATE "product_prices" SET "manufacturing_cost" = $1, "updated_at" = $2 WHERE "product_prices"."id" = $3[0m  [["manufacturing_cost", "0.0"], ["updated_at", "2020-10-03 13:57:29.707511"], ["id", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (4.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.7ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 5069ms (Views: 0.5ms | ActiveRecord: 10.0ms)


  [1m[36mSupplier Load (1.5ms)[0m  [1m[34mSELECT "suppliers".* FROM "suppliers"[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplier Load (0.7ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mSupplierProduct Create (0.9ms)[0m  [1m[32mINSERT INTO "supplier_products" ("supplier_id", "product_id", "supplier_code", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["supplier_id", 3], ["product_id", 15], ["supplier_code", "0055"], ["created_at", "2020-10-03 13:58:08.973874"], ["updated_at", "2020-10-03 13:58:08.973874"], ["quantity", 50]]
  [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProduct Load (0.8ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  [1m[36mCurrency Load (0.6ms)[0m  [1m[34mSELECT  "currencies".* FROM "currencies" WHERE "currencies"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mSupplierProductPrice Create (1.4ms)[0m  [1m[32mINSERT INTO "supplier_product_prices" ("supplier_product_id", "price", "created_at", "updated_at", "currency_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["supplier_product_id", 10], ["price", "120.0"], ["created_at", "2020-10-03 13:58:19.796233"], ["updated_at", "2020-10-03 13:58:19.796233"], ["currency_id", 3]]
  [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:58:22 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.9ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.0ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplierProductPrice Load (0.8ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.7ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
  [1m[36mSupplierProductPrice Load (0.7ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 10], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:58
  [1m[36mSupplier Load (0.6ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 24934ms (Views: 0.6ms | ActiveRecord: 6.0ms)


  [1m[36mSupplierProduct Load (0.4ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 2]]
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (1.1ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 10], ["LIMIT", 1]]
  [1m[36mSupplierProductPrice Destroy (0.6ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 8]]
  [1m[36mSupplierProduct Destroy (0.7ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 10]]
  [1m[35m (36.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mSupplierProduct Load (1.0ms)[0m  [1m[34mSELECT  "supplier_products".* FROM "supplier_products" ORDER BY "supplier_products"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSupplierProductPrice Load (0.7ms)[0m  [1m[34mSELECT  "supplier_product_prices".* FROM "supplier_product_prices" WHERE "supplier_product_prices"."supplier_product_id" = $1 LIMIT $2[0m  [["supplier_product_id", 9], ["LIMIT", 1]]
  [1m[36mSupplierProductPrice Destroy (0.8ms)[0m  [1m[31mDELETE FROM "supplier_product_prices" WHERE "supplier_product_prices"."id" = $1[0m  [["id", 7]]
  [1m[36mSupplierProduct Destroy (1.0ms)[0m  [1m[31mDELETE FROM "supplier_products" WHERE "supplier_products"."id" = $1[0m  [["id", 9]]
  [1m[35m (36.0ms)[0m  [1m[35mCOMMIT[0m
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 17:59:36 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (1.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.5ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
Completed 500 Internal Server Error in 12480ms (ActiveRecord: 3.6ms)


  
NoMethodError (undefined method `supplier_id' for nil:NilClass):
  
app/services/products/product_price_service.rb:60:in `set_prices'
app/services/products/product_price_service.rb:50:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 18:00:22 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.3ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.3ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
Completed 500 Internal Server Error in 6032ms (ActiveRecord: 21.6ms)


  
NoMethodError (undefined method `supplier_id' for nil:NilClass):
  
app/services/products/product_price_service.rb:60:in `set_prices'
app/services/products/product_price_service.rb:50:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 18:00:42 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (0.9ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.1ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplier Load (0.4ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 500 Internal Server Error in 4976ms (ActiveRecord: 24.9ms)


  
NoMethodError (undefined method `name' for nil:NilClass):
  
app/services/products/product_price_service.rb:60:in `set_prices'
app/services/products/product_price_service.rb:50:in `calculation'
app/services/products/product_price_service.rb:19:in `call'
app/controllers/product_prices_controller.rb:11:in `create'
Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 18:01:07 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>0}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.4ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (1.2ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplier Load (1.1ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 7671ms (Views: 0.8ms | ActiveRecord: 28.1ms)


Started POST "/en/product_prices" for 127.0.0.1 at 2020-10-03 18:01:31 +0400
Processing by ProductPricesController#create as JSON
  Parameters: {"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>50, "locale"=>"en", "product_price"=>{"product_id"=>15, "list_price_type"=>"percent", "list_price_amount"=>30, "manufacturing_cost"=>50}}
Unpermitted parameters: :format, :locale, :product_price
  [1m[36mProduct Load (0.7ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:29
  [1m[36mProductPrice Load (1.1ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 ORDER BY "product_prices"."id" ASC LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mCACHE Product Load (0.1ms)[0m  [1m[34mSELECT  "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mProductPrice Update (1.4ms)[0m  [1m[33mUPDATE "product_prices" SET "manufacturing_cost" = $1, "updated_at" = $2 WHERE "product_prices"."id" = $3[0m  [["manufacturing_cost", "50.0"], ["updated_at", "2020-10-03 14:01:41.940575"], ["id", 1]]
  â†³ app/services/products/product_price_service.rb:35
  [1m[35m (36.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/products/product_price_service.rb:35
  [1m[36mSupplierProduct Load (0.7ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:45
  [1m[36mSupplier Load (0.9ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:60
Completed 201 Created in 13098ms (Views: 0.6ms | ActiveRecord: 42.1ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 18:30:23 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 18:30:24 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 18:30:24 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 18:30:24 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 18:30:24 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 18:30:24 +0400
  [1m[36mProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/en/product_prices/price?product_id=15" for 127.0.0.1 at 2020-10-03 18:32:30 +0400
Processing by ProductPricesController#price as JSON
  Parameters: {"product_id"=>"15", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mProductPrice Load (0.4ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:31
  [1m[36mSupplierProduct Load (0.5ms)[0m  [1m[34mSELECT "supplier_products".* FROM "supplier_products" WHERE "supplier_products"."product_id" = $1[0m  [["product_id", 15]]
  â†³ app/services/products/product_price_service.rb:51
  [1m[36mSupplier Load (0.5ms)[0m  [1m[34mSELECT  "suppliers".* FROM "suppliers" WHERE "suppliers"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:64
Completed 200 OK in 28ms (Views: 0.2ms | ActiveRecord: 10.3ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-03 18:58:11 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-03 18:58:11 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-03 18:58:11 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-03 18:58:11 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-03 18:58:11 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-03 18:58:11 +0400
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-06 17:05:46 +0400
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-06 17:05:46 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-06 17:05:46 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-06 17:05:46 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-06 17:05:47 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-06 17:05:47 +0400
  [1m[36mProductPrice Load (2.6ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" ORDER BY "product_prices"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-06 17:33:26 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-06 17:33:26 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-06 17:33:26 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-06 17:33:26 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-06 17:33:26 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-06 17:33:27 +0400
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-06 17:34:01 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-06 17:34:01 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-06 17:34:01 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-06 17:34:01 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-06 17:34:02 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-06 17:34:02 +0400
Started GET "/en/product_prices/%7Bid%7D" for 127.0.0.1 at 2020-10-06 17:34:22 +0400
  
ActionController::RoutingError (No route matches [GET] "/en/product_prices/%7Bid%7D"):
  
actionpack (5.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `block in call'
chewy (5.1.0) lib/chewy/strategy.rb:70:in `wrap'
chewy (5.1.0) lib/chewy.rb:201:in `strategy'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `call'
railties (5.2.1) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
railties (5.2.1) lib/rails/engine.rb:524:in `call'
puma (3.12.0) lib/puma/configuration.rb:225:in `call'
puma (3.12.0) lib/puma/server.rb:658:in `handle_request'
puma (3.12.0) lib/puma/server.rb:472:in `process_client'
puma (3.12.0) lib/puma/server.rb:332:in `block in run'
puma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-06 17:35:28 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-06 17:35:28 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-06 17:35:28 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-06 17:35:28 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-06 17:35:28 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-06 17:35:29 +0400
Started GET "/en/product_prices/%7Bid%7D" for 127.0.0.1 at 2020-10-06 17:35:37 +0400
Processing by ProductPricesController#show as JSON
  Parameters: {"locale"=>"en", "id"=>"{id}"}
Unpermitted parameters: :format, :locale
  [1m[36mProductPrice Load (0.6ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:25
Completed 200 OK in 13ms (Views: 0.3ms | ActiveRecord: 3.5ms)


Started GET "/en/product_prices/%7Bid%7D" for 127.0.0.1 at 2020-10-06 17:36:11 +0400
Processing by ProductPricesController#show as JSON
  Parameters: {"locale"=>"en", "id"=>"{id}"}
Unpermitted parameters: :format, :locale
  [1m[36mProductPrice Load (1.7ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):1
  [1m[36mCACHE ProductPrice Load (0.0ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:26
Completed 200 OK in 30090ms (Views: 0.1ms | ActiveRecord: 9.3ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-06 17:38:37 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-06 17:38:37 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-06 17:38:37 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-06 17:38:37 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-06 17:38:37 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-06 17:38:37 +0400
Started GET "/en/product_prices/15" for 127.0.0.1 at 2020-10-06 17:38:44 +0400
Processing by ProductPricesController#show as JSON
  Parameters: {"locale"=>"en", "id"=>"15"}
Unpermitted parameters: :format, :locale
  [1m[36mProductPrice Load (0.4ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:26
Completed 200 OK in 23829ms (Views: 0.1ms | ActiveRecord: 0.4ms)


Started GET "/en/product_prices/15" for 127.0.0.1 at 2020-10-06 17:39:45 +0400
Processing by ProductPricesController#show as JSON
  Parameters: {"locale"=>"en", "id"=>"15"}
Unpermitted parameters: :format, :locale
  [1m[36mProductPrice Load (0.9ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 LIMIT $2[0m  [["product_id", 15], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:26
Completed 200 OK in 5524ms (Views: 0.7ms | ActiveRecord: 12.6ms)


Started GET "/en/product_prices/56" for 127.0.0.1 at 2020-10-06 17:40:35 +0400
Processing by ProductPricesController#show as JSON
  Parameters: {"locale"=>"en", "id"=>"56"}
Unpermitted parameters: :format, :locale
  [1m[36mProductPrice Load (0.5ms)[0m  [1m[34mSELECT  "product_prices".* FROM "product_prices" WHERE "product_prices"."product_id" = $1 LIMIT $2[0m  [["product_id", 56], ["LIMIT", 1]]
  â†³ app/services/products/product_price_service.rb:26
Completed 200 OK in 4194ms (Views: 0.2ms | ActiveRecord: 0.5ms)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateDepartments (20201007134238)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (63.3ms)[0m  [1m[35mCREATE TABLE "departments" ("id" bigserial primary key, "name" json NOT NULL, "id_name" character varying(50), "active" boolean DEFAULT TRUE NOT NULL)[0m
  â†³ db/migrate/20201007134238_create_departments.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201007134238"]]
  â†³ bin/rails:9
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateSubDepartments (20201007140014)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (10.1ms)[0m  [1m[35mCREATE TABLE "sub_departments" ("id" bigserial primary key, "name" json NOT NULL, "id_name" character varying(50), "active" boolean DEFAULT TRUE NOT NULL, "department_id" integer NOT NULL)[0m
  â†³ db/migrate/20201007140014_create_sub_departments.rb:3
  [1m[35m (7.4ms)[0m  [1m[35mALTER TABLE "sub_departments" ADD CONSTRAINT "fk_rails_6f78497161"
FOREIGN KEY ("department_id")
  REFERENCES "departments" ("id")
[0m
  â†³ db/migrate/20201007140014_create_sub_departments.rb:10
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201007140014"]]
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateSubDepartments (20201007140014)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (4.8ms)[0m  [1m[35mALTER TABLE "sub_departments" DROP CONSTRAINT "fk_rails_6f78497161"[0m
  â†³ bin/rails:9
  [1m[35m (2.6ms)[0m  [1m[35mDROP TABLE "sub_departments"[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20201007140014"]]
  â†³ bin/rails:9
  [1m[35m (3.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
Migrating to CreateDepartments (20201007134238)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE "departments"[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20201007134238"]]
  â†³ bin/rails:9
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mCustomerType Load (2.7ms)[0m  [1m[34mSELECT  "customer_types".* FROM "customer_types" ORDER BY "customer_types"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCustomerType Load (0.9ms)[0m  [1m[34mSELECT "customer_types".* FROM "customer_types"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateCompanies (20201007194524)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "companies" ("id" bigserial primary key, "name" character varying NOT NULL, "description" character varying, "address" character varying, "phone_number" character varying)[0m
  â†³ db/migrate/20201007194524_create_companies.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201007194524"]]
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateCountries (20201007200055)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "countries" ("id" bigserial primary key, "name" character varying NOT NULL, "country_code" character varying NOT NULL)[0m
  â†³ db/migrate/20201007200055_create_countries.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201007200055"]]
  â†³ bin/rails:9
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
Migrating to CreateCities (20201007200103)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (4.8ms)[0m  [1m[35mCREATE TABLE "cities" ("id" bigserial primary key, "name" character varying NOT NULL, "city_code" character varying NOT NULL, "country_id" bigint NOT NULL, CONSTRAINT "fk_rails_996e05be41"
FOREIGN KEY ("country_id")
  REFERENCES "countries" ("id")
)[0m
  â†³ db/migrate/20201007200103_create_cities.rb:3
  [1m[35m (1.4ms)[0m  [1m[35mCREATE  INDEX  "index_cities_on_country_id" ON "cities"  ("country_id")[0m
  â†³ db/migrate/20201007200103_create_cities.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201007200103"]]
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddColumnsToCompany (20201007201451)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "companies" ADD "countries_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (1.8ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_countries_id" ON "companies"  ("countries_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_0db510c354"
FOREIGN KEY ("countries_id")
  REFERENCES "countries" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "companies" ADD "cities_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (1.2ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_cities_id" ON "companies"  ("cities_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_4cf4bc2908"
FOREIGN KEY ("cities_id")
  REFERENCES "cities" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "companies" ADD "parent_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (1.6ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_parent_id" ON "companies"  ("parent_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_d0676b5972"
FOREIGN KEY ("parent_id")
  REFERENCES "parents" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddColumnsToCompany (20201007201451)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "companies" ADD "countries_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (4.1ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_countries_id" ON "companies"  ("countries_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_0db510c354"
FOREIGN KEY ("countries_id")
  REFERENCES "countries" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "companies" ADD "cities_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (3.2ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_cities_id" ON "companies"  ("cities_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_4cf4bc2908"
FOREIGN KEY ("cities_id")
  REFERENCES "cities" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "companies" ADD "parent_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (1.6ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_parent_id" ON "companies"  ("parent_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_d0676b5972"
FOREIGN KEY ("parent_id")
  REFERENCES "parents" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddColumnsToCompany (20201007201451)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "companies" ADD "countries_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (2.5ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_countries_id" ON "companies"  ("countries_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_0db510c354"
FOREIGN KEY ("countries_id")
  REFERENCES "countries" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "companies" ADD "cities_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (1.4ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_cities_id" ON "companies"  ("cities_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (1.4ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_4cf4bc2908"
FOREIGN KEY ("cities_id")
  REFERENCES "cities" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "companies" ADD "parent_id" integer[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_d0676b5972"
FOREIGN KEY ("parent_id")
  REFERENCES "companies" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:6
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201007201451"]]
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" ORDER BY "countries"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-08 01:40:25 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-08 01:40:25 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-08 01:40:25 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-08 01:40:25 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-08 01:40:26 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-08 01:40:26 +0400
Started POST "/%7Blocale%7D/settings/country" for 127.0.0.1 at 2020-10-08 01:41:02 +0400
  
ActionController::RoutingError (uninitialized constant SettingsController):
  
bootsnap (1.3.2) lib/bootsnap/load_path_cache/core_ext/active_support.rb:74:in `block in load_missing_constant'
bootsnap (1.3.2) lib/bootsnap/load_path_cache/core_ext/active_support.rb:8:in `without_bootsnap_cache'
bootsnap (1.3.2) lib/bootsnap/load_path_cache/core_ext/active_support.rb:74:in `rescue in load_missing_constant'
bootsnap (1.3.2) lib/bootsnap/load_path_cache/core_ext/active_support.rb:56:in `load_missing_constant'
activesupport (5.2.1) lib/active_support/inflector/methods.rb:283:in `const_get'
activesupport (5.2.1) lib/active_support/inflector/methods.rb:283:in `block in constantize'
activesupport (5.2.1) lib/active_support/inflector/methods.rb:281:in `each'
activesupport (5.2.1) lib/active_support/inflector/methods.rb:281:in `inject'
activesupport (5.2.1) lib/active_support/inflector/methods.rb:281:in `constantize'
actionpack (5.2.1) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (5.2.1) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:46:in `controller'
actionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:32:in `serve'
actionpack (5.2.1) lib/action_dispatch/journey/router.rb:52:in `block in serve'
actionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `each'
actionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `serve'
actionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:840:in `call'
rack (2.0.5) lib/rack/etag.rb:25:in `call'
rack (2.0.5) lib/rack/conditional_get.rb:38:in `call'
rack (2.0.5) lib/rack/head.rb:12:in `call'
activerecord (5.2.1) lib/active_record/migration.rb:559:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.1) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `block in call'
chewy (5.1.0) lib/chewy/strategy.rb:70:in `wrap'
chewy (5.1.0) lib/chewy.rb:201:in `strategy'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `call'
railties (5.2.1) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
railties (5.2.1) lib/rails/engine.rb:524:in `call'
puma (3.12.0) lib/puma/configuration.rb:225:in `call'
puma (3.12.0) lib/puma/server.rb:658:in `handle_request'
puma (3.12.0) lib/puma/server.rb:472:in `process_client'
puma (3.12.0) lib/puma/server.rb:332:in `block in run'
puma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'
Started POST "/%7Blocale%7D/settings/country" for 127.0.0.1 at 2020-10-08 01:42:36 +0400
  
AbstractController::ActionNotFound (The action 'country' could not be found for SettingsController):
  
actionpack (5.2.1) lib/abstract_controller/base.rb:129:in `process'
actionpack (5.2.1) lib/action_controller/metal.rb:191:in `dispatch'
actionpack (5.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:52:in `dispatch'
actionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:34:in `serve'
actionpack (5.2.1) lib/action_dispatch/journey/router.rb:52:in `block in serve'
actionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `each'
actionpack (5.2.1) lib/action_dispatch/journey/router.rb:35:in `serve'
actionpack (5.2.1) lib/action_dispatch/routing/route_set.rb:840:in `call'
rack (2.0.5) lib/rack/etag.rb:25:in `call'
rack (2.0.5) lib/rack/conditional_get.rb:38:in `call'
rack (2.0.5) lib/rack/head.rb:12:in `call'
activerecord (5.2.1) lib/active_record/migration.rb:559:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.1) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `block in call'
chewy (5.1.0) lib/chewy/strategy.rb:70:in `wrap'
chewy (5.1.0) lib/chewy.rb:201:in `strategy'
chewy (5.1.0) lib/chewy/railtie.rb:19:in `call'
railties (5.2.1) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.1) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.1) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
railties (5.2.1) lib/rails/engine.rb:524:in `call'
puma (3.12.0) lib/puma/configuration.rb:225:in `call'
puma (3.12.0) lib/puma/server.rb:658:in `handle_request'
puma (3.12.0) lib/puma/server.rb:472:in `process_client'
puma (3.12.0) lib/puma/server.rb:332:in `block in run'
puma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'
Started POST "/%7Blocale%7D/settings/country" for 127.0.0.1 at 2020-10-08 01:43:08 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Georgia", "country_code"=>"geo", "locale"=>"{locale}", "setting"=>{"name"=>"Georgia", "country_code"=>"geo"}}
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms)


  
I18n::InvalidLocale ("{locale}" is not a valid locale):
  
app/controllers/application_controller.rb:8:in `set_locale'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-08 01:44:42 +0400
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-08 01:44:42 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-08 01:44:42 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-08 01:44:42 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-08 01:44:43 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-08 01:44:43 +0400
Started POST "/en/settings/country" for 127.0.0.1 at 2020-10-08 01:44:58 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Georgia", "country_code"=>"geo", "locale"=>"en", "setting"=>{"name"=>"Georgia", "country_code"=>"geo"}}
Unpermitted parameters: :format, :locale, :setting
Completed 500 Internal Server Error in 39ms (ActiveRecord: 0.0ms)


  
NameError (undefined local variable or method `paramsp' for #<Settings::CountryAndCityService:0x000055aa02129678>
Did you mean?  params
               @params):
  
app/services/settings/country_and_city_service.rb:22:in `country'
app/controllers/settings_controller.rb:10:in `country'
Started POST "/en/settings/country" for 127.0.0.1 at 2020-10-08 01:45:17 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Georgia", "country_code"=>"geo", "locale"=>"en", "setting"=>{"name"=>"Georgia", "country_code"=>"geo"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."country_code" = $1 ORDER BY "countries"."id" ASC LIMIT $2[0m  [["country_code", "geo"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:22
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[36mCountry Create (3.4ms)[0m  [1m[32mINSERT INTO "countries" ("name", "country_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Georgia"], ["country_code", "geo"]]
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:23
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 10.7ms)


Started POST "/en/settings/country" for 127.0.0.1 at 2020-10-08 01:45:26 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Georgiaaa", "country_code"=>"geo", "locale"=>"en", "setting"=>{"name"=>"Georgiaaa", "country_code"=>"geo"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."country_code" = $1 ORDER BY "countries"."id" ASC LIMIT $2[0m  [["country_code", "geo"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[36mCountry Update (0.3ms)[0m  [1m[33mUPDATE "countries" SET "name" = $1 WHERE "countries"."id" = $2[0m  [["name", "Georgiaaa"], ["id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[35m (3.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:23
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 4.6ms)


Started POST "/en/settings/country" for 127.0.0.1 at 2020-10-08 01:45:34 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Georgia", "country_code"=>"geo", "locale"=>"en", "setting"=>{"name"=>"Georgia", "country_code"=>"geo"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."country_code" = $1 ORDER BY "countries"."id" ASC LIMIT $2[0m  [["country_code", "geo"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[36mCountry Update (0.3ms)[0m  [1m[33mUPDATE "countries" SET "name" = $1 WHERE "countries"."id" = $2[0m  [["name", "Georgia"], ["id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[35m (35.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:23
Completed 200 OK in 39ms (Views: 0.3ms | ActiveRecord: 36.6ms)


Started POST "/en/settings/country" for 127.0.0.1 at 2020-10-08 01:45:43 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Norway", "country_code"=>"nor", "locale"=>"en", "setting"=>{"name"=>"Norway", "country_code"=>"nor"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."country_code" = $1 ORDER BY "countries"."id" ASC LIMIT $2[0m  [["country_code", "nor"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:22
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[36mCountry Create (0.3ms)[0m  [1m[32mINSERT INTO "countries" ("name", "country_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Norway"], ["country_code", "nor"]]
  â†³ app/services/settings/country_and_city_service.rb:23
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:23
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 2.8ms)


Started GET "/en/settings/countries" for 127.0.0.1 at 2020-10-08 01:45:52 +0400
Processing by SettingsController#countries as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
Completed 204 No Content in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms)


Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:46:20 +0400
Processing by SettingsController#city as JSON
  Parameters: {"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :county_id, :format, :locale, :setting
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.0ms)


  
NameError (undefined local variable or method `paramsp' for #<Settings::CountryAndCityService:0x00007f605026c8e0>
Did you mean?  params
               @params):
  
app/services/settings/country_and_city_service.rb:28:in `city'
app/controllers/settings_controller.rb:16:in `city'
Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:47:30 +0400
Processing by SettingsController#city as JSON
  Parameters: {"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :county_id, :format, :locale, :setting
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:36
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "tbl"]]
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:37
Completed 500 Internal Server Error in 12ms (ActiveRecord: 4.5ms)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "country_id" violates not-null constraint
DETAIL:  Failing row contains (1, Tbilisi, tbl, null).
: INSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"):
  
app/services/settings/country_and_city_service.rb:37:in `city'
app/controllers/settings_controller.rb:16:in `city'
Started GET "/en/settings/countries" for 127.0.0.1 at 2020-10-08 01:48:07 +0400
Processing by SettingsController#countries as JSON
  Parameters: {"locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT "countries".* FROM "countries"[0m
  â†³ app/services/settings/country_and_city_service.rb:22
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 2.8ms)


Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:49:08 +0400
Processing by SettingsController#city as JSON
  Parameters: {"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :county_id, :format, :locale, :setting
  [1m[36mCity Load (1.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ (pry):1
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "tbl"]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:38
Completed 500 Internal Server Error in 46648ms (ActiveRecord: 12.3ms)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "country_id" violates not-null constraint
DETAIL:  Failing row contains (2, Tbilisi, tbl, null).
: INSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"):
  
app/services/settings/country_and_city_service.rb:38:in `city'
app/controllers/settings_controller.rb:16:in `city'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:50:48 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by SettingsController#city as JSON
  Parameters: {"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :county_id, :format, :locale, :setting
  [1m[36mCity Load (0.6ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "tbl"]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:38
Completed 500 Internal Server Error in 5253ms (ActiveRecord: 5.7ms)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "country_id" violates not-null constraint
DETAIL:  Failing row contains (3, Tbilisi, tbl, null).
: INSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"):
  
app/services/settings/country_and_city_service.rb:38:in `city'
app/controllers/settings_controller.rb:17:in `city'
Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:51:00 +0400
Processing by SettingsController#city as JSON
  Parameters: {"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :county_id, :format, :locale, :setting
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "tbl"]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:38
Completed 500 Internal Server Error in 37719ms (ActiveRecord: 1.0ms)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "country_id" violates not-null constraint
DETAIL:  Failing row contains (4, Tbilisi, tbl, null).
: INSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"):
  
app/services/settings/country_and_city_service.rb:38:in `city'
app/controllers/settings_controller.rb:17:in `city'
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-08 01:51:40 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-08 01:51:40 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-08 01:51:40 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-08 01:51:40 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-08 01:51:41 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-08 01:51:41 +0400
Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:51:51 +0400
Processing by SettingsController#city as JSON
  Parameters: {"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :county_id, :format, :locale, :setting
  [1m[36mCity Load (1.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[36mCity Create (0.6ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "tbl"]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:38
Completed 500 Internal Server Error in 4014ms (ActiveRecord: 2.4ms)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "country_id" violates not-null constraint
DETAIL:  Failing row contains (5, Tbilisi, tbl, null).
: INSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"):
  
app/services/settings/country_and_city_service.rb:38:in `city'
app/controllers/settings_controller.rb:17:in `city'
Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:52:03 +0400
Processing by SettingsController#city as JSON
  Parameters: {"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"county_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :county_id, :format, :locale, :setting
Unpermitted parameters: :county_id, :format, :locale, :setting
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[36mCity Create (0.5ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "tbl"]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:38
Completed 500 Internal Server Error in 33613ms (ActiveRecord: 1.2ms)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "country_id" violates not-null constraint
DETAIL:  Failing row contains (6, Tbilisi, tbl, null).
: INSERT INTO "cities" ("name", "city_code") VALUES ($1, $2) RETURNING "id"):
  
app/services/settings/country_and_city_service.rb:38:in `city'
app/controllers/settings_controller.rb:17:in `city'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-08 01:52:55 +0400
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-08 01:52:55 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-08 01:52:55 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-08 01:52:55 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-08 01:52:56 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-08 01:52:56 +0400
Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-08 01:53:09 +0400
Processing by SettingsController#city as JSON
  Parameters: {"country_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl", "locale"=>"en", "setting"=>{"country_id"=>1, "name"=>"Tbilisi", "city_code"=>"tbl"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "tbl"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:37
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[36mCity Create (0.7ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code", "country_id") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "tbl"], ["country_id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (36.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:38
Completed 200 OK in 9144ms (Views: 1.1ms | ActiveRecord: 43.3ms)


Started GET "/en/settings/cities?country_id=1" for 127.0.0.1 at 2020-10-08 01:53:31 +0400
Processing by SettingsController#cities as JSON
  Parameters: {"country_id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT "cities".* FROM "cities" WHERE "cities"."country_id" = $1[0m  [["country_id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:26
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 0.4ms)


  [1m[35m (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" ORDER BY "countries"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-08 17:49:24 +0400
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-08 17:49:24 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-08 17:49:24 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-08 17:49:24 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-08 17:49:25 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-08 17:49:25 +0400
Started DELETE "/en/settings/destroy_country?id=1" for 127.0.0.1 at 2020-10-08 17:49:35 +0400
Processing by SettingsController#destroy_country as JSON
  Parameters: {"id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:58
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[36mCountry Destroy (1.3ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:59
Completed 500 Internal Server Error in 20ms (ActiveRecord: 8.8ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "countries" violates foreign key constraint "fk_rails_996e05be41" on table "cities"
DETAIL:  Key (id)=(1) is still referenced from table "cities".
: DELETE FROM "countries" WHERE "countries"."id" = $1):
  
app/services/settings/country_and_city_service.rb:59:in `destroy_country'
app/controllers/settings_controller.rb:34:in `destroy_country'
Started DELETE "/en/settings/destroy_city?id=2" for 127.0.0.1 at 2020-10-08 17:49:53 +0400
Processing by SettingsController#destroy_city as JSON
  Parameters: {"id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:64
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:65
  [1m[36mCountry Destroy (0.9ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 2]]
  â†³ app/services/settings/country_and_city_service.rb:65
  [1m[35m (34.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:65
Completed 200 OK in 39ms (Views: 0.1ms | ActiveRecord: 35.8ms)


Started DELETE "/en/settings/destroy_country?id=2" for 127.0.0.1 at 2020-10-08 17:50:01 +0400
Processing by SettingsController#destroy_country as JSON
  Parameters: {"id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.2ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:58
Completed 404 Not Found in 1ms (ActiveRecord: 0.2ms)


  
ActiveRecord::RecordNotFound (Couldn't find Country with 'id'=2):
  
app/services/settings/country_and_city_service.rb:58:in `destroy_country'
app/controllers/settings_controller.rb:34:in `destroy_country'
Started DELETE "/en/settings/destroy_country?id=1" for 127.0.0.1 at 2020-10-08 17:50:05 +0400
Processing by SettingsController#destroy_country as JSON
  Parameters: {"id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.2ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:58
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[36mCountry Destroy (0.7ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:59
Completed 500 Internal Server Error in 3ms (ActiveRecord: 1.1ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "countries" violates foreign key constraint "fk_rails_996e05be41" on table "cities"
DETAIL:  Key (id)=(1) is still referenced from table "cities".
: DELETE FROM "countries" WHERE "countries"."id" = $1):
  
app/services/settings/country_and_city_service.rb:59:in `destroy_country'
app/controllers/settings_controller.rb:34:in `destroy_country'
Started DELETE "/en/settings/destroy_city?id=1" for 127.0.0.1 at 2020-10-08 17:50:16 +0400
Processing by SettingsController#destroy_city as JSON
  Parameters: {"id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:64
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:65
  [1m[36mCountry Destroy (0.5ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:65
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:65
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.9ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "countries" violates foreign key constraint "fk_rails_996e05be41" on table "cities"
DETAIL:  Key (id)=(1) is still referenced from table "cities".
: DELETE FROM "countries" WHERE "countries"."id" = $1):
  
app/services/settings/country_and_city_service.rb:65:in `destroy_city'
app/controllers/settings_controller.rb:40:in `destroy_city'
Started DELETE "/en/settings/destroy_city?id=1" for 127.0.0.1 at 2020-10-08 17:51:12 +0400
Processing by SettingsController#destroy_city as JSON
  Parameters: {"id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCity Load (0.2ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:64
Completed 404 Not Found in 9ms (ActiveRecord: 3.6ms)


  
ActiveRecord::RecordNotFound (Couldn't find City with 'id'=1):
  
app/services/settings/country_and_city_service.rb:64:in `destroy_city'
app/controllers/settings_controller.rb:40:in `destroy_city'
Started DELETE "/en/settings/destroy_city?id=2" for 127.0.0.1 at 2020-10-08 17:51:19 +0400
Processing by SettingsController#destroy_city as JSON
  Parameters: {"id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:64
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)


  
ActiveRecord::RecordNotFound (Couldn't find City with 'id'=2):
  
app/services/settings/country_and_city_service.rb:64:in `destroy_city'
app/controllers/settings_controller.rb:40:in `destroy_city'
Started DELETE "/en/settings/destroy_country?id=1" for 127.0.0.1 at 2020-10-08 17:51:25 +0400
Processing by SettingsController#destroy_country as JSON
  Parameters: {"id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:58
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[36mCountry Destroy (0.6ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/settings/country_and_city_service.rb:59
Completed 500 Internal Server Error in 10ms (ActiveRecord: 4.1ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "countries" violates foreign key constraint "fk_rails_996e05be41" on table "cities"
DETAIL:  Key (id)=(1) is still referenced from table "cities".
: DELETE FROM "countries" WHERE "countries"."id" = $1):
  
app/services/settings/country_and_city_service.rb:59:in `destroy_country'
app/controllers/settings_controller.rb:34:in `destroy_country'
Started DELETE "/en/settings/destroy_country?id=2" for 127.0.0.1 at 2020-10-08 17:51:31 +0400
Processing by SettingsController#destroy_country as JSON
  Parameters: {"id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.2ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:58
Completed 404 Not Found in 1ms (ActiveRecord: 0.2ms)


  
ActiveRecord::RecordNotFound (Couldn't find Country with 'id'=2):
  
app/services/settings/country_and_city_service.rb:58:in `destroy_country'
app/controllers/settings_controller.rb:34:in `destroy_country'
  [1m[36mCountry Load (1.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" ORDER BY "countries"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCity Load (1.0ms)[0m  [1m[34mSELECT "cities".* FROM "cities"[0m
Started DELETE "/en/settings/destroy_city?id=7" for 127.0.0.1 at 2020-10-08 17:51:56 +0400
Processing by SettingsController#destroy_city as JSON
  Parameters: {"id"=>"7", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:64
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:65
  [1m[36mCity Destroy (0.5ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 7]]
  â†³ app/services/settings/country_and_city_service.rb:65
  [1m[35m (35.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:65
Completed 200 OK in 43ms (Views: 0.2ms | ActiveRecord: 36.7ms)


Started DELETE "/en/settings/destroy_country?id=2" for 127.0.0.1 at 2020-10-08 17:52:05 +0400
Processing by SettingsController#destroy_country as JSON
  Parameters: {"id"=>"2", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.2ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:58
Completed 404 Not Found in 1ms (ActiveRecord: 0.2ms)


  
ActiveRecord::RecordNotFound (Couldn't find Country with 'id'=2):
  
app/services/settings/country_and_city_service.rb:58:in `destroy_country'
app/controllers/settings_controller.rb:34:in `destroy_country'
Started DELETE "/en/settings/destroy_country?id=1" for 127.0.0.1 at 2020-10-08 17:52:08 +0400
Processing by SettingsController#destroy_country as JSON
  Parameters: {"id"=>"1", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCountry Load (0.2ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:58
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[36mCountry Destroy (0.6ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 1]]
  â†³ app/services/settings/country_and_city_service.rb:59
  [1m[35m (36.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:59
Completed 200 OK in 39ms (Views: 0.1ms | ActiveRecord: 36.9ms)


  [1m[36mCompany Load (0.5ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (4.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-09 00:29:20 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-09 00:29:20 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-09 00:29:20 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-09 00:29:20 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-09 00:29:20 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-09 00:29:20 +0400
Started POST "/en/settings/country" for 127.0.0.1 at 2020-10-09 00:30:55 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Georgia", "country_code"=>"GEO", "locale"=>"en", "setting"=>{"name"=>"Georgia", "country_code"=>"GEO"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCountry Load (1.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."country_code" = $1 ORDER BY "countries"."id" ASC LIMIT $2[0m  [["country_code", "GEO"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:39
  [1m[36mCountry Create (1.7ms)[0m  [1m[32mINSERT INTO "countries" ("name", "country_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Georgia"], ["country_code", "GEO"]]
  â†³ app/services/settings/country_and_city_service.rb:39
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:39
Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 10.6ms)


Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-09 00:31:14 +0400
Processing by SettingsController#city as JSON
  Parameters: {"country_id"=>3, "name"=>"Tbilisi", "city_code"=>"TBL", "locale"=>"en", "setting"=>{"country_id"=>3, "name"=>"Tbilisi", "city_code"=>"TBL"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "TBL"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:44
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:45
  [1m[36mCity Create (4.9ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code", "country_id") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "TBL"], ["country_id", 3]]
  â†³ app/services/settings/country_and_city_service.rb:45
  [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:45
Completed 200 OK in 28ms (Views: 0.3ms | ActiveRecord: 15.6ms)


Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-09 00:32:14 +0400
  [1m[35m (1.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-09 00:32:14 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-09 00:32:14 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-09 00:32:14 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-09 00:32:15 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-09 00:32:15 +0400
Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:32:25 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_is"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3}}
Unpermitted parameters: :cities_is, :format, :locale, :company
Completed 500 Internal Server Error in 12ms (ActiveRecord: 5.9ms)


  
NameError (undefined local variable or method `params' for #<Companies::CompaniesService:0x000055cd38657a10>
Did you mean?  @params):
  
app/services/companies/companies_service.rb:26:in `validate_country'
app/services/companies/companies_service.rb:21:in `validate_data!'
app/services/companies/companies_service.rb:14:in `create_company'
app/controllers/companies_controller.rb:10:in `create'
Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:32:47 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_is"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3}}
Unpermitted parameters: :cities_is, :format, :locale, :company
  [1m[36mCountry Load (0.7ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:26
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:38
  [1m[36mCompany Create (1.2ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "countries_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["countries_id", 3]]
  â†³ app/services/companies/companies_service.rb:38
  [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:38
Completed 400 Bad Request in 112ms (Views: 0.2ms | ActiveRecord: 11.2ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:33:14 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_is"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3}}
Unpermitted parameters: :cities_is, :format, :locale, :company
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):1
  [1m[36mCountry Load (0.6ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ (pry):3
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (pry):4
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ (pry):6
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:27
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:40
  [1m[36mCompany Create (0.9ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "countries_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["countries_id", 3]]
  â†³ app/services/companies/companies_service.rb:40
  [1m[35m (4.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:40
Completed 400 Bad Request in 82593ms (Views: 0.3ms | ActiveRecord: 21.9ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:34:52 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_is"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3}}
Unpermitted parameters: :cities_is, :format, :locale, :company
  [1m[36mCountry Load (0.6ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:27
  [1m[36mCity Load (1.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:34
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:40
  [1m[36mCompany Create (0.7ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "countries_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["countries_id", 3]]
  â†³ app/services/companies/companies_service.rb:40
  [1m[35m (36.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:40
Completed 400 Bad Request in 4518ms (Views: 0.6ms | ActiveRecord: 59.7ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:35:13 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_is"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3}}
Unpermitted parameters: :cities_is, :format, :locale, :company
  [1m[36mCountry Load (0.8ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:27
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:40
  [1m[36mCompany Create (0.9ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "countries_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["countries_id", 3]]
  â†³ app/services/companies/companies_service.rb:40
  [1m[35m (36.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:40
Completed 400 Bad Request in 8349ms (Views: 0.5ms | ActiveRecord: 62.3ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:35:35 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_is"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3}}
Unpermitted parameters: :cities_is, :format, :locale, :company
  [1m[36mCountry Load (0.9ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:27
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:34
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:40
  [1m[36mCompany Create (1.4ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "countries_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["countries_id", 3]]
  â†³ app/services/companies/companies_service.rb:40
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:40
Completed 400 Bad Request in 35464ms (Views: 0.4ms | ActiveRecord: 4.7ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:36:13 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_is"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3}}
Unpermitted parameters: :cities_is, :format, :locale, :company
  [1m[36mCountry Load (0.8ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:27
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:34
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:40
  [1m[36mCompany Create (0.6ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "countries_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["countries_id", 3]]
  â†³ app/services/companies/companies_service.rb:40
  [1m[35m (36.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:40
Completed 400 Bad Request in 14784ms (Views: 0.5ms | ActiveRecord: 59.1ms)


  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-09 00:36:48 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-09 00:36:48 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-09 00:36:48 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-09 00:36:48 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-09 00:36:49 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-09 00:36:49 +0400
Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:37:04 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_id"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_id"=>8}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.9ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:27
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:34
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:40
  [1m[36mCompany Create (1.7ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "countries_id", "cities_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["countries_id", 3], ["cities_id", 8]]
  â†³ app/services/companies/companies_service.rb:40
  [1m[35m (36.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:40
Completed 204 No Content in 13319ms (Views: 0.2ms | ActiveRecord: 49.3ms)


  [1m[36mCompany Load (0.8ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT "countries".* FROM "countries"[0m
  [1m[36mCountry Load (0.8ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" ORDER BY "countries"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCountry Destroy (6.8ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 3]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Destroy (2.1ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 8]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Destroy (5.5ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 8]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Destroy (1.8ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 8]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Destroy (1.1ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 8]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mCity Load (0.5ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Destroy (0.8ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 8]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Destroy (2.0ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 8]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (1.0ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 7]]
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (0.5ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (0.5ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 6]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (1.0ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 5]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (1.0ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 4]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (1.0ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (1.0ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (1.3ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 2]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (0.8ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 1]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (0.8ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.8ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.8ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCity Load (0.8ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCity Destroy (0.9ms)[0m  [1m[31mDELETE FROM "cities" WHERE "cities"."id" = $1[0m  [["id", 8]]
  [1m[35m (36.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCity Load (0.8ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.8ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCity Load (0.8ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" ORDER BY "cities"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.4ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCountry Load (1.1ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" ORDER BY "countries"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCountry Destroy (2.2ms)[0m  [1m[31mDELETE FROM "countries" WHERE "countries"."id" = $1[0m  [["id", 3]]
  [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCountry Load (0.6ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" ORDER BY "countries"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCountry Load (0.8ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" ORDER BY "countries"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (1.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddColumnsToCompany (20201007201451)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (2.2ms)[0m  [1m[35mALTER TABLE "companies" DROP COLUMN "countries_id"[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:10
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "companies" DROP COLUMN "cities_id"[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:11
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "companies" DROP COLUMN "parent_id"[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:12
  [1m[36mActiveRecord::SchemaMigration Destroy (0.7ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20201007201451"]]
  â†³ bin/rails:9
  [1m[35m (3.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddColumnsToCompany (20201007201451)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "companies" ADD "country_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (4.7ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_country_id" ON "companies"  ("country_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (5.9ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_75b15a5c36"
FOREIGN KEY ("country_id")
  REFERENCES "countries" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:3
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "companies" ADD "city_id" bigint[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (1.7ms)[0m  [1m[35mCREATE  INDEX  "index_companies_on_city_id" ON "companies"  ("city_id")[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_268726594d"
FOREIGN KEY ("city_id")
  REFERENCES "cities" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:4
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "companies" ADD "parent_id" integer[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:5
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "companies" ADD CONSTRAINT "fk_rails_d0676b5972"
FOREIGN KEY ("parent_id")
  REFERENCES "companies" ("id")
[0m
  â†³ db/migrate/20201007201451_add_columns_to_company.rb:6
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201007201451"]]
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(2027190067205577435)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mCompany Load (0.4ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:45:49 +0400
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /home/buka/.rvm/gems/ruby-2.6.5/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_id"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250"}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (1.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:32
Completed 500 Internal Server Error in 3767ms (ActiveRecord: 17.5ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'countries_id' for Company.):
  
app/services/companies/companies_service.rb:44:in `create_company_obj'
app/services/companies/companies_service.rb:20:in `create_company'
app/controllers/companies_controller.rb:11:in `create'
  [1m[36mCompany Load (1.1ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:46:24 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>3, "cities_id"=>8, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250"}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.7ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:32
Completed 500 Internal Server Error in 3182ms (ActiveRecord: 12.1ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'countries_id' for Company.):
  
app/services/companies/companies_service.rb:44:in `create_company_obj'
app/services/companies/companies_service.rb:20:in `create_company'
app/controllers/companies_controller.rb:11:in `create'
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-09 00:47:56 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-09 00:47:57 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-09 00:47:57 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-09 00:47:57 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-09 00:47:57 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-09 00:47:57 +0400
Started POST "/en/settings/country" for 127.0.0.1 at 2020-10-09 00:48:35 +0400
Processing by SettingsController#country as JSON
  Parameters: {"name"=>"Georgia", "country_code"=>"GEO", "locale"=>"en", "setting"=>{"name"=>"Georgia", "country_code"=>"GEO"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCountry Load (1.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."country_code" = $1 ORDER BY "countries"."id" ASC LIMIT $2[0m  [["country_code", "GEO"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:38
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:39
  [1m[36mCountry Create (0.5ms)[0m  [1m[32mINSERT INTO "countries" ("name", "country_code") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Georgia"], ["country_code", "GEO"]]
  â†³ app/services/settings/country_and_city_service.rb:39
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:39
Completed 200 OK in 26ms (Views: 0.2ms | ActiveRecord: 11.8ms)


Started POST "/en/settings/city" for 127.0.0.1 at 2020-10-09 00:49:03 +0400
Processing by SettingsController#city as JSON
  Parameters: {"country_id"=>4, "name"=>"Tbilisi", "city_code"=>"TBL", "locale"=>"en", "setting"=>{"country_id"=>4, "name"=>"Tbilisi", "city_code"=>"TBL"}}
Unpermitted parameters: :format, :locale, :setting
  [1m[36mCity Load (0.8ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."city_code" = $1 ORDER BY "cities"."id" ASC LIMIT $2[0m  [["city_code", "TBL"], ["LIMIT", 1]]
  â†³ app/services/settings/country_and_city_service.rb:44
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/settings/country_and_city_service.rb:45
  [1m[36mCity Create (0.8ms)[0m  [1m[32mINSERT INTO "cities" ("name", "city_code", "country_id") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "Tbilisi"], ["city_code", "TBL"], ["country_id", 4]]
  â†³ app/services/settings/country_and_city_service.rb:45
  [1m[35m (36.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/settings/country_and_city_service.rb:45
Completed 200 OK in 54ms (Views: 0.3ms | ActiveRecord: 41.7ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:49:24 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>4, "cities_id"=>9, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250"}}
Unpermitted parameters: :countries_id, :cities_id, :format, :locale, :company
  [1m[36mCountry Load (1.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:32
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:45
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/companies/companies_service.rb:45
Completed 400 Bad Request in 7363ms (Views: 0.5ms | ActiveRecord: 8.5ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:50:04 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "countries_id"=>4, "cities_id"=>9, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250"}}
Unpermitted parameters: :countries_id, :cities_id, :format, :locale, :company
  [1m[36mCountry Load (0.6ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:32
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:45
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/companies/companies_service.rb:45
Completed 400 Bad Request in 40801ms (Views: 0.8ms | ActiveRecord: 1.5ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:51:05 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>9, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>9}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.7ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:32
  [1m[36mCity Load (0.9ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:39
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:45
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:45
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:45
  [1m[36mCompany Create (1.2ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "country_id", "city_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["country_id", 4], ["city_id", 9]]
  â†³ app/services/companies/companies_service.rb:45
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:45
Completed 201 Created in 7174ms (Views: 0.2ms | ActiveRecord: 6.3ms)


  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (1.0ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCountry Load (0.9ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mCompany Load (0.6ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mCompany Load (0.8ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mCompany Destroy (1.6ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 8]]
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-09 00:55:37 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-09 00:55:37 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-09 00:55:37 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-09 00:55:37 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-09 00:55:37 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-09 00:55:38 +0400
Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 00:55:48 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>9, "locale"=>"en", "company"=>{"name"=>"Bukas LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat n10", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>9}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (1.2ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:31
  [1m[36mCity Load (1.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:38
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:44
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:44
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:44
  [1m[36mCompany Create (0.8ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "country_id", "city_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Bukas LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat n10"], ["phone_number", "577520250"], ["country_id", 4], ["city_id", 9]]
  â†³ app/services/companies/companies_service.rb:44
  [1m[35m (4.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:44
Completed 201 Created in 6491ms (Views: 0.5ms | ActiveRecord: 35.3ms)


  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
  [1m[36mCompany Load (1.2ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT "companies".* FROM "companies"[0m
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-09 01:21:36 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-09 01:21:36 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-09 01:21:36 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-09 01:21:36 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-09 01:21:37 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-09 01:21:37 +0400
Started PUT "/en/companies" for 127.0.0.1 at 2020-10-09 01:22:30 +0400
Processing by CompaniesController#update as JSON
  Parameters: {"id"=>9, "name"=>"changed name for test", "description"=>"changed description for test", "address"=>"changed address for test", "phone_number"=>"changed phone for test", "country_id"=>4, "city_id"=>9, "locale"=>"en", "company"=>{"id"=>9, "name"=>"changed name for test", "description"=>"changed description for test", "address"=>"changed address for test", "phone_number"=>"changed phone for test", "country_id"=>4, "city_id"=>9}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.4ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:35
  [1m[36mCity Load (0.8ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:41
  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT "companies".* FROM "companies"[0m
  â†³ app/services/companies/companies_service.rb:52
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:52
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:52
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:52
  [1m[36mCompany Update (0.6ms)[0m  [1m[33mUPDATE "companies" SET "name" = $1, "description" = $2, "address" = $3, "phone_number" = $4 WHERE "companies"."id" = $5[0m  [["name", "changed name for test"], ["description", "changed description for test"], ["address", "changed address for test"], ["phone_number", "changed phone for test"], ["id", 9]]
  â†³ app/services/companies/companies_service.rb:52
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:52
Completed 500 Internal Server Error in 52ms (ActiveRecord: 19.6ms)


  
NoMethodError (undefined method `errors' for #<Array:0x00007f17d84a2710>):
  
app/services/companies/companies_service.rb:53:in `update_company_obj'
app/services/companies/companies_service.rb:24:in `update_company'
app/controllers/companies_controller.rb:16:in `update'
Started PUT "/en/companies" for 127.0.0.1 at 2020-10-09 01:23:32 +0400
Processing by CompaniesController#update as JSON
  Parameters: {"id"=>9, "name"=>"changed name for test", "description"=>"changed description for test", "address"=>"changed address for test", "phone_number"=>"changed phone for test", "country_id"=>4, "city_id"=>9, "locale"=>"en", "company"=>{"id"=>9, "name"=>"changed name for test", "description"=>"changed description for test", "address"=>"changed address for test", "phone_number"=>"changed phone for test", "country_id"=>4, "city_id"=>9}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:35
  [1m[36mCity Load (0.4ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:41
  [1m[36mCompany Load (0.3ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" WHERE "companies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:52
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:53
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:53
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:53
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:53
Completed 200 OK in 71ms (Views: 0.4ms | ActiveRecord: 15.5ms)


  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ spec/rails_helper.rb:34
Started GET "/api-docs/index.html" for 127.0.0.1 at 2020-10-09 01:36:06 +0400
Started GET "/api-docs/swagger-ui.css" for 127.0.0.1 at 2020-10-09 01:36:06 +0400
Started GET "/api-docs/swagger-ui-bundle.js" for 127.0.0.1 at 2020-10-09 01:36:06 +0400
Started GET "/api-docs/swagger-ui-standalone-preset.js" for 127.0.0.1 at 2020-10-09 01:36:06 +0400
Started GET "/api-docs/v1/swagger.json" for 127.0.0.1 at 2020-10-09 01:36:07 +0400
Started GET "/api-docs/favicon-32x32.png" for 127.0.0.1 at 2020-10-09 01:36:07 +0400
Started DELETE "/en/companies?id=9" for 127.0.0.1 at 2020-10-09 01:36:18 +0400
Processing by CompaniesController#destroy as JSON
  Parameters: {"id"=>"9", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCompany Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "companies" WHERE "companies"."parent_id" = $1 LIMIT $2[0m  [["parent_id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:42
  [1m[36mCompany Load (0.3ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" WHERE "companies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:74
Completed 404 Not Found in 28ms (Views: 0.2ms | ActiveRecord: 9.2ms)


  [1m[36mCompany Load (0.5ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started DELETE "/en/companies?id=9" for 127.0.0.1 at 2020-10-09 01:36:44 +0400
Processing by CompaniesController#destroy as JSON
  Parameters: {"id"=>"9", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCompany Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "companies" WHERE "companies"."parent_id" = $1 LIMIT $2[0m  [["parent_id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:42
  [1m[36mCompany Load (0.4ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" WHERE "companies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:74
Completed 404 Not Found in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)


  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (1.0ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.9ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.8ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" ORDER BY "companies"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started DELETE "/en/companies?id=9" for 127.0.0.1 at 2020-10-09 01:37:19 +0400
Processing by CompaniesController#destroy as JSON
  Parameters: {"id"=>"9", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCompany Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "companies" WHERE "companies"."parent_id" = $1 LIMIT $2[0m  [["parent_id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:43
  [1m[36mCompany Load (0.7ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" WHERE "companies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ (pry):14
  [1m[36mCACHE Company Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "companies" WHERE "companies"."parent_id" = $1 LIMIT $2[0m  [["parent_id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:43
  [1m[36mCompany Load (1.4ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" WHERE "companies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:75
Completed 404 Not Found in 58226ms (Views: 0.6ms | ActiveRecord: 14.7ms)


Started DELETE "/en/companies?id=9" for 127.0.0.1 at 2020-10-09 01:38:20 +0400
Processing by CompaniesController#destroy as JSON
  Parameters: {"id"=>"9", "locale"=>"en"}
Unpermitted parameters: :format, :locale
  [1m[36mCompany Load (0.3ms)[0m  [1m[34mSELECT "companies".* FROM "companies" WHERE "companies"."parent_id" = $1[0m  [["parent_id", 9]]
  â†³ app/services/companies/companies_service.rb:43
  [1m[36mCompany Load (0.4ms)[0m  [1m[34mSELECT  "companies".* FROM "companies" WHERE "companies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:75
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:36
  [1m[36mCompany Destroy (0.7ms)[0m  [1m[31mDELETE FROM "companies" WHERE "companies"."id" = $1[0m  [["id", 9]]
  â†³ app/services/companies/companies_service.rb:36
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:36
Completed 200 OK in 5289ms (Views: 0.2ms | ActiveRecord: 7.6ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 01:39:21 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Buka LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat 13", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>8, "locale"=>"en", "company"=>{"name"=>"Buka LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat 13", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>8}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.5ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:52
  [1m[36mCity Load (0.7ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:58
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/companies/companies_service.rb:64
Completed 400 Bad Request in 44ms (Views: 0.2ms | ActiveRecord: 10.5ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 01:39:28 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Buka LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat 13", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>9, "locale"=>"en", "company"=>{"name"=>"Buka LTD", "description"=>"Software development company", "address"=>"Gogebashvili streat 13", "phone_number"=>"577520250", "country_id"=>4, "city_id"=>9}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:52
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:58
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCompany Create (1.1ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "country_id", "city_id") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Buka LTD"], ["description", "Software development company"], ["address", "Gogebashvili streat 13"], ["phone_number", "577520250"], ["country_id", 4], ["city_id", 9]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:64
Completed 201 Created in 13ms (Views: 0.2ms | ActiveRecord: 4.1ms)


Started POST "/en/companies" for 127.0.0.1 at 2020-10-09 01:40:04 +0400
Processing by CompaniesController#create as JSON
  Parameters: {"name"=>"Buka LTD _test", "description"=>"Software development company test", "address"=>"Gogebashvili streat 13/test", "phone_number"=>"5775202500000", "country_id"=>4, "city_id"=>9, "parent_id"=>10, "locale"=>"en", "company"=>{"name"=>"Buka LTD _test", "description"=>"Software development company test", "address"=>"Gogebashvili streat 13/test", "phone_number"=>"5775202500000", "country_id"=>4, "city_id"=>9, "parent_id"=>10}}
Unpermitted parameters: :format, :locale, :company
  [1m[36mCountry Load (0.3ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:52
  [1m[36mCity Load (0.3ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:58
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCACHE Country Load (0.0ms)[0m  [1m[34mSELECT  "countries".* FROM "countries" WHERE "countries"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCACHE City Load (0.0ms)[0m  [1m[34mSELECT  "cities".* FROM "cities" WHERE "cities"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[36mCompany Create (0.9ms)[0m  [1m[32mINSERT INTO "companies" ("name", "description", "address", "phone_number", "country_id", "city_id", "parent_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "Buka LTD _test"], ["description", "Software development company test"], ["address", "Gogebashvili streat 13/test"], ["phone_number", "5775202500000"], ["country_id", 4], ["city_id", 9], ["parent_id", 10]]
  â†³ app/services/companies/companies_service.rb:64
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/companies/companies_service.rb:64
Completed 201 Created in 9ms (Views: 0.2ms | ActiveRecord: 2.9ms)


